{"version":3,"sources":["Assets/logoSentiersEstrie.png","Assets/logoUniversiteSherbrooke.png","DesktopComponents/Button/SentiersButton.tsx","Utils/colors.ts","DesktopComponents/Preview/Styles.tsx","DesktopComponents/PreviewInterestPoint/PreviewInterestPoint.tsx","DesktopComponents/PreviewTrail/PreviewTrail.tsx","DesktopComponents/PreviewMap/PreviewMap.tsx","DesktopComponents/PreviewZone/PreviewZone.tsx","DesktopComponents/Preview/Preview.tsx","DesktopViews/PreviewView.ts","Utils/DatabaseUtils.ts","DesktopViews/UpdateView.ts","DesktopControllers/UpdateAppMap.tsx","DesktopViews/DownloadLastFile.ts","DesktopComponents/LastUsedExcel/LastUsedExcel.tsx","Assets/sentiersImages.ts","Utils/HeaderSentier.tsx","App.tsx","reportWebVitals.js","index.js","models/coordinatemodel.ts","models/queries.ts","models/completemodel.ts","models/interestpointsmodel.ts","models/usermapmodel.ts","models/zonemodel.ts","models/interestpointdatamodel.ts","models/trailmodel.ts","Utils/ImportExcelFile.ts","models/partner.ts"],"names":["MyButtonTypes","SentiersButton","text","type","color","hover","textColor","textColorHover","icon","borderColor","onClick","useState","isHover","setIsHover","stateBackground","setBackgroundColor","stateColor","setStateColor","useEffect","style","backgroundColor","onMouseOver","onMouseLeave","className","marginRight","colors","useStyles","makeStyles","theme","addInfos","textAlign","normalText","fontWeight","padding","headings","margin","title","display","fontSize","rowNotColored","rowColored","circularProgress","accordionElement","width","border","borderRadius","marginBottom","contentAligner","flexDirection","preview","accordionDoubleElement","root","expandIcon","PreviewInterestPoint","model","zoneId","mapId","interestPointName","itemNumber","premiseInterestPoint","setInterestPoint","classes","poi","Queries","getInterestPointsFromObjectModel","name","code","description","active","toString","coordinate","longitude","latitude","PreviewTrail","trailName","premiseTrail","setTrail","trail","getTrailFromObjectModel","difficulty","PreviewMap","premiseMapId","setMapId","Map","trails","setTrails","interestPoints","setIterestPoints","completeModel","getUserMapFromObjectModel","pointsOfInterest","Accordion","AccordionSummary","aria-controls","id","AccordionDetails","size","arrayOfTrails","forEach","push","convertArrayOfTrails","map","index","arrayOfPoi","convertArrayOfPoi","interestPoint","PreviewZone","premiseZoneId","setZoneId","maps","setMaps","zone","getZoneFromObjectModel","_id","arrayOfMaps","convertArrayOfMaps","Preview","m","CompleteModel","setModel","zones","setZones","isLoading","setIsLoading","CircularProgress","arrayOfzones","convertArrayOfZones","sendForPreview","excel","a","defaultModel","isSent","Promise","resolve","ImportExcelFile","fetchDataFromExcelFromBrowser","undefined","doneModel","DatabaseUtils","e","postRequestToServer","JSON","stringify","toJson","response","console","log","toSend","isExcel","formdata","destinationUri","FormData","append","requestHeaders","Accept","requestOptions","method","headers","body","fetch","status","document","createElement","appendChild","setAttribute","href","click","window","URL","revokeObjectURL","error","sendForUpdate","sendModelToServer","SendingState","ErrorMessages","UpdateAppMap","visibilityToggle","receivedFile","setFile","displayPreview","setDisplayPreview","fileName","setFileName","aFileWasAdded","setAFileWasAdded","modelRecieved","message","none","sendingState","UNKNOWN","errorMessage","setErrorMessage","sendForPreviewOnClick","file","failedToParse","ERROR","cancelUpdateOnClick","sendForUpdateOnClick","succeedToSend","SUCCESS","failedToSend","marginTop","alignItems","accept","required","event","target","value","onChange","files","item","split","pop","notAnExcel","missingFile","small","faFileImport","doc","getElementById","fontStyle","marginLeft","Alert","severity","large","medium","confirm","getLastUpdatedDate","getDateFromAppStatus","LastUsedExcel","lastUpdadedDate","setLastUpdadedDate","faFileDownload","downloadFile","failedToDownload","images","logoSentiersEstrie","require","logoUniversiteSherbrooke","Header","src","default","alt","unstable_createMuiStrictModeTheme","App","isVisible","setIsVisibile","ThemeProvider","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","Coordinate","altitude","this","zoneName","z","get","Error","userMapName","um","t","interest_id","model_by_ref","key","ref","zone_name","set","err","usermap_name","trail_name","trailCoordinates","ipd","interest_point_name","data","partners","Array","jsonObject","InterestType","getInterestType","x","InterestPoint","uri","jsonObjectT","indexOf","parking","view","telephone","picnic","camping","refuge","hosting","restroom","unknown","UserMap","map_file","topLeftCoordinate","topRightCoordinate","bottomLeftCoordinate","bottomRightCoordinate","b","length","usermaps","Zone","DataType","getDataType","InterestPointData","Trail","point","sentiers","sentierName","csv","xlsx","wb","Workbook","defaultMap","trailID","readFile","worksheets","eachRow","row","rowNumber","zoneString","getCell","has","insertMap","insertUserMapInZoneMaps","trailFile","newTrail","insertTrailInUserMap","MigrateServicesData","MigrateTrailCoordinate","write_success","ReverseEngineerWorkbookProgrammatically","csvFile","concat","Number","c","s","poiName","insertedType","getTypeFromString","newPOI","filename","separator","parseExcelFile","getWorksheet","cellvalue","ws_UserMap","filepath","tlLong","tlLat","trLong","trLat","blLong","blLat","brLong","brLat","ws_Trail","keyCell","trailDescription","valueOf","ws_coordinateSentier","insertCoordinateInTrail","ws_interestPoints","poiTypeString","poiLong","poiLat","it","ip","insertInterestPointInUserMap","ipd_type","datatype","ipd_data","insertInterestPointDataInInterestPoint","ws_Partners","p","Partner","Excel","arrayBuffer","arrayBuff","toBuffer","buffer","load","book","ab","buf","Buffer","alloc","byteLength","Uint8Array","i","creator","created","Date","key_sheet","addWorksheet","views","state","ySplit","zone_sheet","usermap_sheet","sentier_sheet","coordinateSentier_sheet","interestPoint_sheet","interestPointData_sheet","partners_sheet","ExcelModel","FormatModelToExcel","ColumnsModel","MakeColumnsMap","addTableWrapper","getColumn","eachCell","includeEmpty","cell","definedNames","addFormula","dataValidationWrapper","writeFile","sheet","table_name","columns","excel_model","model_key","addTable","headerRow","showRowStripes","rows","makeColumnsPretty","ColumnsMap","filterButton","zoneRows","usermapRows","sentierRows","coordinateSentierRows","interestPointRows","interestPointDataRows","partnersRows","usermap","interest_point","interest_point_data","partner","column","maxLength","columnLength","formula","foreign_key","feuille","dataValidation","allowBlank","showInputMessage","formulae","promptTitle","prompt"],"mappings":"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","file":"static/js/main.71117090.chunk.js","sourcesContent":["export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/logoUniversiteSherbrooke.fd5b9722.png\";","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useEffect, useState } from \"react\";\nimport \"./Styles.css\";\n/*\nLe component pour chacun des boutons de la plateforme web \n*/\n\nexport enum MyButtonTypes {\n  small = \"small\",\n  medium = \"medium\",\n  large = \"large\",\n}\n\ntype MyButtonProps = {\n  text: string;\n  type: MyButtonTypes;\n  color: string;\n  hover: string;\n  textColor: string;\n  textColorHover?: string;\n  icon?: any;\n  borderColor: string;\n  onClick: () => void;\n};\n\nexport default function SentiersButton({\n  text,\n  type,\n  color,\n  hover,\n  textColor,\n  textColorHover,\n  icon,\n  borderColor,\n  onClick,\n}: MyButtonProps): JSX.Element {\n  const [isHover, setIsHover] = useState<boolean>(false);\n  const [stateBackground, setBackgroundColor] = useState<string>(color);\n  const [stateColor, setStateColor] = useState<string>(textColor);\n\n  useEffect(() => {\n    if (isHover) {\n      setBackgroundColor(hover);\n      setStateColor(textColorHover!);\n    } else {\n      setBackgroundColor(color);\n      setStateColor(textColor);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isHover]);\n\n  return (\n    <button\n      style={{\n        backgroundColor: stateBackground,\n        color: stateColor,\n        borderColor: borderColor,\n      }}\n      onMouseOver={() => setIsHover(true)}\n      onMouseLeave={() => setIsHover(false)}\n      className={\"button \" + type}\n      onClick={onClick}\n    >\n      {icon && (\n        <FontAwesomeIcon\n          icon={icon}\n          style={{\n            marginRight: 15,\n            color: stateColor,\n          }}\n        />\n      )}\n      {text}\n    </button>\n  );\n}\n","export const colors = {\n  red: \"red\",\n  black: \"black\",\n  white: \"white\",\n  transparent: \"transparent\",\n  preview: \"#4d6d8a\",\n  previewHover: \"#375066\",\n  redBanner: \"#930000\",\n  redBannerHover: \"#800000\",\n  graySentiersEstrie: \"#cccccc\",\n  graySentiersEstrieHover: \"#9c9898\",\n  confirmationButtonColor: \"#149414\",\n  confirmationButtonHover: \"#649568\",\n  cancelButtonColor: \"#ed2939\",\n  cancelButtonHover: \"#cd5c5c\",\n  rowNotColored: \"#F1F1F1\",\n  rowColored: \"#DFDFDF\",\n  accordion: \"#375066\",\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\nimport { colors } from \"../../Utils/colors\";\n\nconst useStyles = makeStyles((theme) => ({\n  addInfos: {\n    textAlign: \"center\",\n  },\n  normalText: {\n    fontWeight: \"bold\",\n    padding: \"2%\",\n  },\n  headings: {\n    fontWeight: \"bold\",\n    margin: 0,\n  },\n  title: {\n    display: \"block\",\n    fontSize: \"1.5em\",\n    margin: \"0.83em 0\",\n    fontWeight: \"bold\",\n  },\n  rowNotColored: {\n    backgroundColor: colors.rowNotColored,\n    padding: \"10px\",\n  },\n  rowColored: {\n    backgroundColor: colors.rowColored,\n    padding: \"10px\",\n  },\n  circularProgress: {\n    color: colors.graySentiersEstrieHover,\n    padding: \"5px\",\n  },\n  accordionElement: {\n    width: \"100%\",\n    border: \"2px solid \" + colors.accordion,\n    borderRadius: \"5px\",\n    marginBottom: \"5px\",\n  },\n  contentAligner: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    width: \"100%\",\n  },\n  preview: {\n    margin: \"0 8%\",\n  },\n  accordionDoubleElement: {\n    width: \"100%\",\n    borderRadius: \"5px\",\n  },\n  root: {\n    backgroundColor: colors.accordion,\n    color: \"white\",\n  },\n  expandIcon: {\n    color: \"white\",\n  },\n}));\n\nexport { useStyles };\n","import { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { InterestPoint } from \"../../models/interestpointsmodel\";\nimport { Queries } from \"../../models/queries\";\nimport { useStyles } from \"../Preview/Styles\";\n\ntype MyPreviewInterestPointProps = {\n  model: CompleteModel;\n  zoneId: string;\n  mapId: string;\n  interestPointName: string;\n  itemNumber: number;\n};\n\n/**\n * Méthode qui fait l'affichage des informations d'un point d'intérêt dans la section de prévisualisation\n * @param MyPreviewInterestPointProps Propriétés servant à l'indentification du point d'intérêt qu'on veut prévisualiser\n * @returns {JSX.Element} Elements JSX, qui permet l'affichage de la section\n */\nexport default function PreviewInterestPoint({\n  model,\n  zoneId,\n  mapId,\n  interestPointName,\n  itemNumber,\n}: MyPreviewInterestPointProps): JSX.Element {\n  const [premiseInterestPoint, setInterestPoint] = useState<InterestPoint>();\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    const poi = Queries.getInterestPointsFromObjectModel(\n      model,\n      zoneId,\n      mapId,\n      interestPointName\n    );\n    setInterestPoint(poi);\n  });\n\n  return (\n    <div\n      className={\n        itemNumber % 2 !== 0 ? classes.rowColored : classes.rowNotColored\n      }\n    >\n      <div className=\"poiName\">\n        <b>{premiseInterestPoint?.name} </b>\n      </div>\n      <div className=\"poiCode\">\n        <u>Code</u> : {premiseInterestPoint?.code}\n      </div>\n      <div className=\"poiType\">\n        <u>Type</u> : {premiseInterestPoint?.type}\n      </div>\n      <div className=\"poiType\">\n        <u>Description</u> : {premiseInterestPoint?.description}\n      </div>\n      <div className=\"poiActive\">\n        <u> actif </u> :{\" \"}\n        {premiseInterestPoint?.active?.toString() === \"true\" ? \"Vrai\" : \"Faux\"}\n      </div>\n      <div className=\"poiCoordinate\">\n        <div>\n          <u>Longitude</u> : {premiseInterestPoint?.coordinate.longitude}{\" \"}\n        </div>\n        <div>\n          <u>Latitude</u> :{premiseInterestPoint?.coordinate.latitude}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { Queries } from \"../../models/queries\";\nimport { Trail } from \"../../models/trailmodel\";\nimport { useStyles } from \"../Preview/Styles\";\n\ntype MyPreviewTrailProps = {\n  model: CompleteModel;\n  zoneId: string;\n  mapId: string;\n  trailName: string;\n  itemNumber: number;\n};\n\n/**\n * Méthode qui fait l'affichage des informations d'un sentier dans la section de prévisualisation\n * @param MyPreviewTrailProps Propriétés servant à l'indentification du sentier qu'on veut prévisualiser\n * @returns {JSX.Element} Elements JSX, qui permet l'affichage de la section\n */\nexport default function PreviewTrail({\n  model,\n  zoneId,\n  mapId,\n  trailName,\n  itemNumber,\n}: MyPreviewTrailProps): JSX.Element {\n  const [premiseTrail, setTrail] = useState<Trail>();\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    const trail = Queries.getTrailFromObjectModel(\n      model,\n      zoneId,\n      mapId,\n      trailName\n    );\n    setTrail(trail);\n  });\n\n  return (\n    <div\n      className={\n        itemNumber % 2 !== 0 ? classes.rowColored : classes.rowNotColored\n      }\n    >\n      <div className=\"trailName\">\n        <b> {premiseTrail?.name} </b>\n      </div>\n      <div className={classes.addInfos}>\n        <div className=\"trailDifficulty\">\n          <u>Difficulté</u> : {premiseTrail?.difficulty}\n        </div>\n        <div className=\"trailDescription\">\n          <u>Description</u> : {premiseTrail?.description}\n        </div>\n        <div className=\"trailColor\">\n          <u>Couleur</u> : {premiseTrail?.color}\n        </div>\n        <div className=\"trailActive\">\n          <u> actif </u> :{\" \"}\n          {premiseTrail?.active?.toString() === \"true\" ? \"Vrai\" : \"Faux\"}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import Accordion from \"@material-ui/core/Accordion\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport React, { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { InterestPoint } from \"../../models/interestpointsmodel\";\nimport { Queries } from \"../../models/queries\";\nimport { Trail } from \"../../models/trailmodel\";\nimport { useStyles } from \"../Preview/Styles\";\nimport PreviewInterestPoint from \"../PreviewInterestPoint/PreviewInterestPoint\";\nimport PreviewTrail from \"../PreviewTrail/PreviewTrail\";\n\ntype MyPreviewMapProps = {\n  model: CompleteModel;\n  zoneId: string;\n  mapId: string;\n};\n/**\n * Méthode qui fait l'affichage des informations d'une carte dans la section de prévisualisation\n * @param MyPreviewMapProps Propriétés servant à l'indentification de la carte qu'on veut prévisualiser\n * @returns {JSX.Element} Elements JSX, qui permet l'affichage de la section\n */\nexport default function PreviewMap({\n  model,\n  zoneId,\n  mapId,\n}: MyPreviewMapProps): JSX.Element {\n  const [premiseMapId, setMapId] = useState<string>(\"\");\n  const [trails, setTrails] = useState<Map<string, Trail>>(\n    new Map<string, Trail>()\n  );\n  const [interestPoints, setIterestPoints] = useState<\n    Map<string, InterestPoint>\n  >(new Map<string, InterestPoint>());\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    const completeModel = Queries.getUserMapFromObjectModel(\n      model,\n      zoneId,\n      mapId\n    );\n    setMapId(completeModel.name);\n    setTrails(completeModel.trails);\n    setIterestPoints(completeModel.pointsOfInterest);\n  });\n\n  function convertArrayOfTrails(): Trail[] {\n    const arrayOfTrails: Trail[] = [];\n    trails.forEach((trail) => arrayOfTrails.push(trail));\n    return arrayOfTrails;\n  }\n\n  function convertArrayOfPoi(): InterestPoint[] {\n    const arrayOfPoi: InterestPoint[] = [];\n    interestPoints.forEach((poi) => arrayOfPoi.push(poi));\n    return arrayOfPoi;\n  }\n\n  return (\n    <div className={classes.accordionElement}>\n      <Accordion>\n        <AccordionSummary\n          expandIcon={<ExpandMoreIcon className={classes.expandIcon} />}\n          aria-controls=\"panel1a-content\"\n          id={premiseMapId}\n          className={classes.root}\n        >\n          <p className={classes.headings}> Carte : {premiseMapId} </p>\n        </AccordionSummary>\n        <AccordionDetails>\n          <div className={classes.accordionDoubleElement}>\n            <div className={classes.accordionElement}>\n              <div>\n                <Accordion>\n                  <AccordionSummary\n                    expandIcon={\n                      <ExpandMoreIcon className={classes.expandIcon} />\n                    }\n                    aria-controls=\"panel1a-content\"\n                    className={classes.root}\n                  >\n                    <p className={classes.headings}> Sentiers </p>\n                  </AccordionSummary>\n                  {trails.size === 0 ? (\n                    <p className={classes.normalText}>\n                      Vous avez créé une carte sans lui associer de sentier(s)\n                    </p>\n                  ) : (\n                    <AccordionDetails>\n                      <div className={classes.contentAligner}>\n                        {/* Pour chaque sentiers de la carte */}\n                        {convertArrayOfTrails().map((trail: Trail, index) => (\n                          // Afficher le sentier\n                          <PreviewTrail\n                            key={trail.name}\n                            model={model}\n                            zoneId={zoneId}\n                            mapId={premiseMapId}\n                            trailName={trail.name}\n                            itemNumber={index}\n                          />\n                        ))}\n                      </div>\n                    </AccordionDetails>\n                  )}\n                </Accordion>\n              </div>\n            </div>\n            <div className={classes.accordionElement}>\n              <div>\n                <Accordion>\n                  <AccordionSummary\n                    expandIcon={\n                      <ExpandMoreIcon className={classes.expandIcon} />\n                    }\n                    aria-controls=\"panel1a-content\"\n                    className={classes.root}\n                  >\n                    <p className={classes.headings}> Points d'intérêt </p>\n                  </AccordionSummary>\n                  {interestPoints.size === 0 ? (\n                    <p className={classes.normalText}>\n                      Vous avez créé une carte sans lui associer de point(s)\n                      d'intérêt\n                    </p>\n                  ) : (\n                    <AccordionDetails>\n                      <div className={classes.contentAligner}>\n                        {/* Pour chaque points d'intérêt de la carte */}\n                        {convertArrayOfPoi().map(\n                          (interestPoint: InterestPoint, index) => (\n                            // Afficher le point d'intérêt\n                            <PreviewInterestPoint\n                              key={interestPoint.name}\n                              model={model}\n                              zoneId={zoneId}\n                              mapId={premiseMapId}\n                              interestPointName={interestPoint.name}\n                              itemNumber={index}\n                            />\n                          )\n                        )}\n                      </div>\n                    </AccordionDetails>\n                  )}\n                </Accordion>\n              </div>\n            </div>\n          </div>\n        </AccordionDetails>\n      </Accordion>\n    </div>\n  );\n}\n","import Accordion from \"@material-ui/core/Accordion\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport React, { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { Queries } from \"../../models/queries\";\nimport { UserMap } from \"../../models/usermapmodel\";\nimport { useStyles } from \"../Preview/Styles\";\nimport PreviewMap from \"../PreviewMap/PreviewMap\";\n\ntype MyPreviewZoneProps = {\n  model: CompleteModel;\n  zoneId: string;\n};\n\n/**\n * Méthode qui fait l'affichage des informations d'une zone dans la section de prévisualisation\n * @param MyPreviewZoneProps Propriétés servant à l'indentification de la zone qu'on veut prévisualiser\n * @returns {JSX.Element} Elements JSX, qui permet l'affichage de la section\n */\nexport default function PreviewZone({\n  model,\n  zoneId,\n}: MyPreviewZoneProps): JSX.Element {\n  const [premiseZoneId, setZoneId] = useState<string>(\"\");\n  const [maps, setMaps] = useState<Map<string, UserMap>>(\n    new Map<string, UserMap>()\n  );\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    const zone = Queries.getZoneFromObjectModel(model, zoneId);\n    setZoneId(zone._id);\n    setMaps(zone.maps);\n  });\n\n  function convertArrayOfMaps(): UserMap[] {\n    const arrayOfMaps: UserMap[] = [];\n    maps.forEach((map) => arrayOfMaps.push(map));\n    return arrayOfMaps;\n  }\n\n  return (\n    <div className={classes.accordionElement}>\n      <Accordion>\n        <AccordionSummary\n          expandIcon={<ExpandMoreIcon className={classes.expandIcon} />}\n          aria-controls=\"panel1a-content\"\n          id={premiseZoneId}\n          className={classes.root}\n        >\n          <p className={classes.headings}> Zone : {premiseZoneId} </p>\n        </AccordionSummary>\n        {maps.size === 0 ? (\n          <p className={classes.normalText}>\n            Vous avez créé une zone sans lui associer de carte(s)\n          </p>\n        ) : (\n          <AccordionDetails>\n            <div className={classes.contentAligner}>\n              {/* Pour chaque cartes de la zone */}\n              {convertArrayOfMaps().map((map: UserMap) => (\n                // Afficher la carte\n                <PreviewMap\n                  key={map.name}\n                  model={model}\n                  zoneId={premiseZoneId}\n                  mapId={map.name}\n                />\n              ))}\n            </div>\n          </AccordionDetails>\n        )}\n      </Accordion>\n    </div>\n  );\n}\n","import Accordion from \"@material-ui/core/Accordion\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport React, { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport PreviewZone from \"../PreviewZone/PreviewZone\";\nimport { Zone } from \"./../../models/zonemodel\";\nimport { useStyles } from \"./Styles\";\n\ntype MyProp = {\n  m: CompleteModel;\n};\n\n/**\n * Méthode qui fait l'affichage de la section pour prévisualiser le contenu qu'on s'apprete à utiliser pour mettre à jour l'app mobile.\n * @param MyProp Le model représentant le contenu qu'on veut prévisualiser.\n * @returns {JSX.Element} Elements JSX, qui permet l'affichage de la section\n */\nexport default function Preview({ m }: MyProp): JSX.Element {\n  const [model, setModel] = useState<CompleteModel>(new CompleteModel());\n  const [zones, setZones] = useState<Map<string, Zone>>(\n    new Map<string, Zone>()\n  );\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const classes = useStyles();\n\n  useEffect(() => {\n    setIsLoading(true);\n    setModel(m);\n    setZones(m.zones);\n    setIsLoading(false);\n    // eslint-disable-next-line\n  }, []);\n\n  function convertArrayOfZones(): Zone[] {\n    const arrayOfzones: Zone[] = [];\n    zones.forEach((zone) => arrayOfzones.push(zone));\n    return arrayOfzones;\n  }\n\n  return (\n    <div className={classes.preview}>\n      <p className={classes.title}> Aperçu des données </p>\n      <div className={classes.accordionElement}>\n        <Accordion>\n          <AccordionSummary\n            expandIcon={<ExpandMoreIcon className={classes.expandIcon} />}\n            aria-controls=\"panel1a-content\"\n            id=\"accordionSummary\"\n            className={classes.root}\n          >\n            <p className={classes.headings}> Zones </p>\n          </AccordionSummary>\n          {isLoading ? (\n            <CircularProgress className={classes.circularProgress} />\n          ) : zones.size === 0 ? (\n            <p> Vous n'avez pas de zones </p>\n          ) : (\n            <AccordionDetails>\n              <div className={classes.contentAligner}>\n                {\n                  // boucle for each sur les zones dans l'objet\n                  convertArrayOfZones().map((zone: Zone) => (\n                    // afficher la zone\n                    <PreviewZone\n                      key={zone._id}\n                      model={model}\n                      zoneId={zone._id}\n                    />\n                  ))\n                }\n              </div>\n            </AccordionDetails>\n          )}\n        </Accordion>\n      </div>\n    </div>\n  );\n}\n","import { CompleteModel } from \"../models/completemodel\";\nimport { ImportExcelFile } from \"../Utils/ImportExcelFile\";\n\n/**\n * Méthode avoir un preview du contenu que l'utilisateur veut ajuster sur l'application\n *\n * @param excel Le fichier excel à parser.\n * @returns {Promise <{Promise<boolean>,Promise<CompleteModel>}> }, Vrai si les informations ont reussi à être parsées ainsi que le model resultant.\n */\nexport default async function sendForPreview(excel: File) {\n  var defaultModel = new CompleteModel();\n  if (excel.name === \"\") {\n    return {\n      isSent: Promise.resolve(false),\n      model: Promise.resolve(defaultModel),\n    };\n  }\n  var doneModel = await ImportExcelFile.fetchDataFromExcelFromBrowser(excel);\n  if (\n    doneModel === undefined ||\n    doneModel.zones === undefined ||\n    doneModel.zones.size === 0\n  ) {\n    return {\n      isSent: Promise.resolve(false),\n      model: Promise.resolve(defaultModel),\n    };\n  }\n  return { isSent: Promise.resolve(true), model: Promise.resolve(doneModel) };\n}\n","import { CompleteModel } from \"../models/completemodel\";\n\nexport class DatabaseUtils {\n  /**\n   * La fonction permet d'envoyer sur le serveur le model et le excel servant à mettre à jour l'application mobile.\n   * @param excel le fichier excel complet ayant servi à mettre jour l'application mobile.\n   * @param model le model représentant le contenu du excel.\n   * @returns un message d'erreur si une erreur est survenue, null sinon\n   */\n  static async sendModelToServer(excel: File, model: CompleteModel) {\n    var e = null;\n    try {\n      // envoyer le json\n      var response = await DatabaseUtils.postRequestToServer(\n        JSON.stringify(model.toJson()),\n        false\n      );\n      if (response === 200) {\n        // envoyer le excel\n        response = await DatabaseUtils.postRequestToServer(excel, true);\n        if (response === 200) {\n          return e;\n        }\n      }\n      return \" Le statut de la réponse HTTP éronée est : \" + response;\n    } catch (err) {\n      e = err;\n      console.log(e);\n    }\n\n    return e;\n  }\n\n  /**\n   * La fonction qui fait une requête POST au serveur.\n   * @param toSend le contenu à envoyer.\n   * @param isExcel boolean indiquant si le contenu à envoyer est un fichier ou non.\n   * @returns {Promise<number>} le statut de la réponse\n   */\n  static async postRequestToServer(\n    toSend: any,\n    isExcel: boolean\n  ): Promise<number> {\n    var formdata = toSend;\n    var requestHeaders;\n\n    var destinationUri =\n      \"http://sentiersest.web810.discountasp.net/updateAppContent\";\n\n    if (isExcel) {\n      formdata = new FormData();\n      formdata.append(\"spreadsheet\", toSend);\n      destinationUri = \"http://sentiersest.web810.discountasp.net/uploadFile\";\n      requestHeaders = {\n        Accept: \"*/*\",\n      };\n    } else {\n      requestHeaders = {\n        \"Content-Type\": \"application/json\",\n      };\n    }\n\n    var requestOptions: RequestInit = {\n      method: \"POST\",\n      headers: requestHeaders,\n      body: formdata,\n    };\n    try {\n      var response = await fetch(destinationUri, requestOptions);\n      return response.status;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  /**\n   * La fonction qui permet d'obtenir les informations de la dernière mise à jour de l'application mobile.\n   * @returns {Promise<string>} la date de la dernière mise à jour de l'application mobile.\n   */\n  static async getDateFromAppStatus(): Promise<string> {\n    try {\n      var requestOptions = {\n        method: \"GET\",\n      };\n      var response = await fetch(\n        \"http://sentiersest.web810.discountasp.net/getStatus\",\n        requestOptions\n      );\n      return response.text();\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  /**\n   * La fonction qui permet de télécharger le dernier excel servant à mettre à jour l'application mobile.\n   * @returns {boolean} Vrai si le téléchargement a été effectué, faux sinon.\n   */\n  static downloadFile(): boolean {\n    try {\n      var a = document.createElement(\"a\");\n      document.body.appendChild(a);\n      a.setAttribute(\"style\", \"display: none;\");\n      a.href = \"http://sentiersest.web810.discountasp.net/downloadFile\";\n      a.click();\n      window.URL.revokeObjectURL(\n        \"http://sentiersest.web810.discountasp.net/downloadFile\"\n      );\n      return true;\n    } catch (error) {\n      console.log(error);\n      return false;\n    }\n  }\n}\n","import { CompleteModel } from \"../models/completemodel\";\nimport { DatabaseUtils } from \"../Utils/DatabaseUtils\";\n\n/**\n * Méthode pour confirmer la mise à jour de l'application selon le preview.\n *\n * @param excel Le fichier excel à envoyer sur le serveur..\n * @param model Le model à envoyer sur le serveur.\n * @returns {Promise<boolean>} vrai si les informations ont été envoyées au serveur.\n */\nexport async function sendForUpdate(\n  excel: File,\n  model: CompleteModel\n): Promise<boolean> {\n  var error = await DatabaseUtils.sendModelToServer(excel, model);\n  if (error === null) {\n    return Promise.resolve(true);\n  } else {\n    console.log(\"Erreur lors de l'envoi sur le serveur. \" + error);\n    return Promise.resolve(false);\n  }\n}\n","import { faFileImport } from \"@fortawesome/free-solid-svg-icons\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport React, { useState } from \"react\";\nimport SentiersButton, {\n  MyButtonTypes,\n} from \"../DesktopComponents/Button/SentiersButton\";\nimport Preview from \"../DesktopComponents/Preview/Preview\";\nimport sendForPreview from \"../DesktopViews/PreviewView\";\nimport { sendForUpdate } from \"../DesktopViews/UpdateView\";\nimport { CompleteModel } from \"../models/completemodel\";\nimport { colors } from \"../Utils/colors\";\nimport \"./Styles.css\";\n\nexport enum SendingState {\n  ERROR = \"error\",\n  SUCCESS = \"success\",\n  UNKNOWN = \"unsend\",\n  WARNING = \"warning\",\n}\n\nexport enum ErrorMessages {\n  failedToSend = \" Une erreur est survenue lors de la mise à jour du contenu de l'application. \",\n  none = \"\",\n  succeedToSend = \" L'application a été mise à jour! \",\n  notAnExcel = \" Vous n'avez pas selectionné un fichier .xlsx! \",\n  failedToParse = \" Veuillez entrer un excel adapté à l'application. \",\n  missingFile = \"Veuillez sélectionner un fichier. \",\n  failedToDownload = \" Une erreur est survenue lors du téléchargement du fichier. \",\n  succeedToDownload = \" Le fichier a été téléchargé! \",\n}\n\ntype Props = {\n  visibilityToggle: (isVisible: boolean) => void;\n};\n\n/**\n * Méthode qui fait l'affichage de la section pour mettre à jour l'application ainsi que le preview\n * @param Props Propriétés servant à indiqué si on veut afficher la section\n * @returns {JSX.Element} Elements JSX, qui permet l'affichage de la section\n */\nexport default function UpdateAppMap({ visibilityToggle }: Props): JSX.Element {\n  const [receivedFile, setFile] = useState<File>();\n  const [displayPreview, setDisplayPreview] = useState<boolean>(false);\n  const [fileName, setFileName] = useState<string>(\"\");\n  const [aFileWasAdded, setAFileWasAdded] = useState<boolean>(false);\n  const [modelRecieved, setModel] = useState<CompleteModel>(\n    new CompleteModel()\n  );\n\n  const [errorMessage, setErrorMessage] = useState<{\n    message: ErrorMessages;\n    sendingState: SendingState;\n  }>({\n    message: ErrorMessages.none,\n    sendingState: SendingState.UNKNOWN,\n  });\n\n  function resetInput(event: any) {\n    event.target.value = \"\";\n  }\n\n  // vérifier que l'utilisateur a bien selectioné un fichier excel\n  function HandleFileInput(event: React.ChangeEvent<HTMLInputElement>): void {\n    const file = event.target.files?.item(0);\n    setDisplayPreview(false);\n    visibilityToggle(true);\n    setErrorMessage({\n      message: ErrorMessages.none,\n      sendingState: SendingState.UNKNOWN,\n    });\n    if (file !== undefined) {\n      if (file!.name.split(\".\").pop() === \"xlsx\") {\n        setAFileWasAdded(true);\n        setFile(file!);\n        setFileName(file!.name);\n      } else {\n        // Erreur de fichier, ce n'est pas un Excel\n        setErrorMessage({\n          message: ErrorMessages.notAnExcel,\n          sendingState: SendingState.ERROR,\n        });\n      }\n    } else {\n      // Erreur de fichier, ce n'est pas un Excel\n      setErrorMessage({\n        message: ErrorMessages.missingFile,\n        sendingState: SendingState.ERROR,\n      });\n    }\n  }\n\n  async function sendForPreviewOnClick(file: File) {\n    var response = await sendForPreview(file!);\n    var isSent = await response.isSent;\n    setModel(await response.model);\n    setDisplayPreview(isSent);\n    // on affiche la section permettant de télécharger le dernier Excel seulement si la section de preview n'est pas affichée\n    visibilityToggle(!isSent);\n    if (!isSent) {\n      setErrorMessage({\n        message: ErrorMessages.failedToParse,\n        sendingState: SendingState.ERROR,\n      });\n    }\n  }\n\n  async function cancelUpdateOnClick() {\n    setErrorMessage({\n      message: ErrorMessages.none,\n      sendingState: SendingState.UNKNOWN,\n    });\n    setDisplayPreview(false);\n    // on affiche la section permettant de télécharger le dernier Excel maintenant qu'on ne voit plus la section de preview\n    visibilityToggle(true);\n    setFileName(\"\");\n    setFile(undefined);\n    setAFileWasAdded(false);\n  }\n\n  async function sendForUpdateOnClick(file: File, model: CompleteModel) {\n    const statusSend: boolean = await sendForUpdate(file!, model);\n    if (statusSend) {\n      setErrorMessage({\n        message: ErrorMessages.succeedToSend,\n        sendingState: SendingState.SUCCESS,\n      });\n      setFileName(\"\");\n      setFile(undefined);\n      setDisplayPreview(false);\n      // on affiche la section permettant de télécharger le dernier Excel car la section de preview ne sera plus affichée\n      visibilityToggle(true);\n      setAFileWasAdded(false);\n    } else {\n      setErrorMessage({\n        message: ErrorMessages.failedToSend,\n        sendingState: SendingState.ERROR,\n      });\n    }\n  }\n\n  return (\n    <div className=\"updateAppMap\">\n      <h2>Mettre à jour l'application mobile</h2>\n      <div className=\"form\">\n        <div className=\"infoForPreview\">\n          <div className=\"fileInputSection\">\n            <p style={{ marginTop: \"0px\" }}>\n              Veuillez sélectionner un fichier Excel\n            </p>\n            <div style={{ display: \"flex\", alignItems: \"center\" }}>\n              <div className=\"importFileButton\">\n                <input\n                  type=\"file\"\n                  id=\"selectedFile\"\n                  style={{ display: \"none\" }}\n                  accept=\".xlsx\"\n                  required\n                  onClick={resetInput}\n                  onChange={HandleFileInput}\n                />\n                <SentiersButton\n                  type={MyButtonTypes.small}\n                  color={colors.graySentiersEstrie}\n                  hover={colors.graySentiersEstrieHover}\n                  text={\"Importer un fichier\"}\n                  textColor={colors.black}\n                  textColorHover={colors.white}\n                  borderColor={colors.graySentiersEstrie}\n                  icon={faFileImport}\n                  onClick={() => {\n                    var doc = document.getElementById(\"selectedFile\");\n                    if (doc) {\n                      doc.click();\n                    }\n                  }}\n                />\n                {receivedFile?.name ? (\n                  <p\n                    style={{\n                      fontSize: 11,\n                      fontStyle: \"italic\",\n                      marginLeft: \"1em\",\n                    }}\n                  >\n                    {fileName}\n                  </p>\n                ) : null}\n              </div>\n            </div>\n            {errorMessage.sendingState !== SendingState.UNKNOWN ? (\n              <div>\n                <Alert\n                  severity={errorMessage.sendingState}\n                  style={{ marginTop: \"10px\" }}\n                >\n                  {errorMessage.message}\n                </Alert>\n              </div>\n            ) : null}\n          </div>\n          {/*afficher le bouton de previsualistion si un nouveau fichier de type excel est entré et qu'il n'y a pas d'erreur */}\n          {aFileWasAdded &&\n          !displayPreview &&\n          errorMessage.sendingState !== SendingState.ERROR ? (\n            <div className=\"previewSection\">\n              <p>\n                Afin de mettre à jour l’application, assurez-vous de\n                prévisualiser le contenu et le confirmer\n              </p>\n              <div className=\"previewButton\">\n                <SentiersButton\n                  color={colors.redBanner}\n                  hover={colors.redBannerHover}\n                  textColorHover={colors.white}\n                  type={MyButtonTypes.large}\n                  text={\"Prévisualiser\"}\n                  textColor={colors.white}\n                  borderColor={colors.redBannerHover}\n                  onClick={async () => {\n                    await sendForPreviewOnClick(receivedFile!);\n                  }}\n                />\n              </div>\n            </div>\n          ) : null}\n        </div>\n      </div>\n      {displayPreview ? (\n        <div className=\"infoForUpdate\">\n          <div className=\"UpdateButtons\">\n            <div className=\"cancelButton\">\n              <SentiersButton\n                color={colors.transparent}\n                hover={colors.red}\n                type={MyButtonTypes.medium}\n                text={\"Annuler\"}\n                textColor={colors.red}\n                textColorHover={colors.white}\n                borderColor={colors.red}\n                onClick={async () => {\n                  await cancelUpdateOnClick();\n                }}\n              />\n            </div>\n            <div className=\"confirmButton\">\n              <SentiersButton\n                color={colors.confirmationButtonColor}\n                hover={colors.confirmationButtonHover}\n                type={MyButtonTypes.medium}\n                text={\"Confirmer\"}\n                textColor={colors.white}\n                textColorHover={colors.white}\n                borderColor={colors.confirmationButtonColor}\n                onClick={async () => {\n                  if (\n                    window.confirm(\n                      \"Êtes-vous sûr de vouloir envoyer ces données dans le système? Une fois envoyées, vous ne pourrez plus annuler cette opération.\"\n                    )\n                  ) {\n                    await sendForUpdateOnClick(receivedFile!, modelRecieved);\n                  }\n                }}\n              />\n            </div>\n          </div>\n          <Preview key=\"preview\" m={modelRecieved} />\n        </div>\n      ) : null}\n    </div>\n  );\n}\n","import { DatabaseUtils } from \"../Utils/DatabaseUtils\";\n\n/**\n *\n * Méthode pour télécharger le dernier Excel utilisé pour mettre à jour l'aplication.\n * @returns {boolean} Vrai si le fichier a été téléchargé. Faux si le fichier n'a pas été téléchargé.\n */\nexport function downloadFile(): boolean {\n  return DatabaseUtils.downloadFile();\n}\n\n/**\n * Méthode pour avoir la date du dernier update.\n * @returns {Promise<string>} La date et l'heure de la dernière mise à jour.\n */\nexport async function getLastUpdatedDate(): Promise<string> {\n  return await DatabaseUtils.getDateFromAppStatus();\n}\n","import { faFileDownload } from \"@fortawesome/free-solid-svg-icons\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport { useEffect, useState } from \"react\";\nimport {\n  ErrorMessages,\n  SendingState,\n} from \"../../DesktopControllers/UpdateAppMap\";\nimport {\n  downloadFile,\n  getLastUpdatedDate,\n} from \"../../DesktopViews/DownloadLastFile\";\nimport { colors } from \"../../Utils/colors\";\nimport SentiersButton, { MyButtonTypes } from \"../Button/SentiersButton\";\nimport \"./Styles.css\";\n/**\n * Méthode qui fait l'affichage de la section qui permet le téléchargement du dernier excel ayant servi à mettre à jour l'application mobile\n *\n * @returns {JSX.Element} Elements JSX, qui permet l'affichage de la section\n */\nexport default function LastUsedExcel(): JSX.Element {\n  const [lastUpdadedDate, setLastUpdadedDate] = useState<string>(\"\");\n  const [errorMessage, setErrorMessage] = useState<{\n    message: ErrorMessages;\n    sendingState: SendingState;\n  }>({\n    message: ErrorMessages.none,\n    sendingState: SendingState.UNKNOWN,\n  });\n\n  // Mettre à jour la date qui indique la dernière mise à jour de l'app mobile\n  useEffect(() => {\n    (async () => {\n      setLastUpdadedDate(await getLastUpdatedDate());\n    })();\n  }, []);\n\n  return (\n    <div\n      className=\"lastUsedExcel\"\n      style={{ backgroundColor: colors.graySentiersEstrie }}\n    >\n      <h2> Dernière mise à jour de l'application </h2>\n      <p> {lastUpdadedDate} </p>\n      <div className=\"contentSection\" style={{ borderColor: colors.redBanner }}>\n        <div className=\"getFileSection\">\n          <p className=\"titleLastUsedExcel\">\n            Cliquez ici pour récuperer la dernière version de Excel qui a mis à\n            jour l'application mobile\n          </p>\n          {/* Bouton permettant de télécharger le dernier fichier excel qui a servi à mettre à jour l'app mobile */}\n          <div className=\"buttonToDownloadFile\">\n            <SentiersButton\n              color={colors.redBanner}\n              hover={colors.redBannerHover}\n              textColorHover={colors.white}\n              type={MyButtonTypes.small}\n              text={\"Télécharger\"}\n              textColor={colors.white}\n              borderColor={colors.redBannerHover}\n              icon={faFileDownload}\n              onClick={async () => {\n                var isSent = await downloadFile();\n                if (!isSent) {\n                  setErrorMessage({\n                    message: ErrorMessages.failedToDownload,\n                    sendingState: SendingState.ERROR,\n                  });\n                }\n              }}\n            />\n          </div>\n          {/* Afficher message d'erreur à l'utilisateur si besoin */}\n          {errorMessage.sendingState !== SendingState.UNKNOWN && (\n            <div className=\"errorMessage\">\n              <Alert\n                className=\"alertLastUsedExcel\"\n                severity={errorMessage.sendingState}\n              >\n                {errorMessage.message}\n              </Alert>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","export const images = {\n  logoSentiersEstrie: require(\"./logoSentiersEstrie.png\"),\n  logoUniversiteSherbrooke: require(\"./logoUniversiteSherbrooke.png\"),\n};\n","import { images } from \"../Assets/sentiersImages\";\nimport { colors } from \"./colors\";\nimport \"./Styles.css\";\n\nexport default function Header(): JSX.Element {\n  return (\n    <div className=\"topBanner\" style={{ backgroundColor: colors.redBanner }}>\n      <div className=\"column\">\n        <img src={images.logoSentiersEstrie.default} alt=\"logoSentiersEstrie\" />\n      </div>\n    </div>\n  );\n}\n","import {\n  ThemeProvider,\n  unstable_createMuiStrictModeTheme,\n} from \"@material-ui/core/styles\";\nimport React, { useState } from \"react\";\nimport \"./App.css\";\nimport LastUsedExcel from \"./DesktopComponents/LastUsedExcel/LastUsedExcel\";\nimport UpdateAppMap from \"./DesktopControllers/UpdateAppMap\";\nimport Header from \"./Utils/HeaderSentier\";\nconst theme = unstable_createMuiStrictModeTheme();\n\nfunction App(): JSX.Element {\n  const [isVisible, setIsVisibile] = useState<boolean>(true);\n\n  return (\n    <div className=\"App\">\n      <ThemeProvider theme={theme}>\n        <Header />\n        <UpdateAppMap visibilityToggle={setIsVisibile} />\n        {isVisible && <LastUsedExcel />}\n      </ThemeProvider>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","/**\n * Structure de donnée pour une coordonnée\n */\nexport class Coordinate {\n    longitude: number | undefined;\n    latitude: number | undefined;\n    altitude: number | undefined;\n\n    constructor(longitude: number | undefined, latitude:number | undefined, altitude:number | undefined = undefined) {\n      this.longitude = longitude;\n      this.latitude = latitude;\n      this.altitude = altitude;\n    }\n}","import { CompleteModel } from \"./completemodel\";\nimport { Coordinate } from \"./coordinatemodel\";\nimport { InterestPointData } from \"./interestpointdatamodel\";\nimport { InterestPoint } from \"./interestpointsmodel\";\nimport { Trail } from \"./trailmodel\";\nimport { UserMap } from \"./usermapmodel\";\n\n/**\n * Classe pour écrire des requêtes noSQL\n */\nexport class Queries {\n  /**\n   * Retourne un objet Zone à partir du modèle objet complet.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone que l'on veut obtenir.\n   * @returns un objet Zone.\n   */\n  static getZoneFromObjectModel(model: CompleteModel, zoneName: string) {\n    let z = model.zones.get(zoneName);\n    if (z === undefined) {\n      throw new Error(\"zone inexistant: \" + zoneName);\n    }\n    return z;\n  }\n\n  /**\n   * Retourne un objet UserMap à partir d'un objet CompleteModel.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone contenant le UserMap.\n   * @param userMapName L'ID de la carte contenannt le UserMap.\n   * @returns un objet UserMap.\n   */\n  static getUserMapFromObjectModel(\n    model: CompleteModel,\n    zoneName: string,\n    userMapName: string\n  ) {\n    let z = model.zones.get(zoneName);\n    if (z === undefined) {\n      throw new Error(\"zone inexistante: \" + zoneName);\n    }\n\n    let um = z.maps.get(userMapName);\n    if (um === undefined) {\n      throw new Error(\"carte inexistante: \" + userMapName);\n    }\n\n    return um;\n  }\n\n  /**\n   * Retourne un objet Sentier à partir d'un objet CompleteModel.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone contenant le sentier.\n   * @param userMapName L'ID de la carte contenant le sentier.\n   * @param sentierName L'ID du sentier que l'on veut obtenir.\n   * @returns un objet Sentier.\n   */\n  static getTrailFromObjectModel(\n    model: CompleteModel,\n    zoneName: string,\n    userMapName: string,\n    trailName: string\n  ) {\n    let z = model.zones.get(zoneName);\n    if (z === undefined) {\n      throw new Error(\"zone inexistante: \" + zoneName);\n    }\n\n    let um = z.maps.get(userMapName);\n    if (um === undefined) {\n      throw new Error(\"carte inexistante: \" + userMapName);\n    }\n\n    let t = um.trails.get(trailName);\n    if (t === undefined) {\n      throw new Error(\"sentier inexistant: \" + trailName);\n    }\n    return t;\n  }\n\n  /**\n   * Retourne un objet InterestPoint à partir d'un objet CompleteModel.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone contenant le point d'interet.\n   * @param userMapName L'ID de la carte contenant le point d'interet.\n   * @param interest_id L'ID du point d'interet que l'on veut.\n   * @returns un objet InterestPoint.\n   */\n  static getInterestPointsFromObjectModel(\n    model: CompleteModel,\n    zoneName: string,\n    userMapName: string,\n    interest_id: string\n  ) {\n    let z = model.zones.get(zoneName);\n    if (z === undefined) {\n      throw new Error(\"zone inexistante: \" + zoneName);\n    }\n\n    let um = z.maps.get(userMapName);\n    if (um === undefined) {\n      throw new Error(\"carte inexistante: \" + userMapName);\n    }\n\n    let poi = um.pointsOfInterest.get(interest_id);\n    if (poi === undefined) {\n      throw new Error(\"point d'interet inexistant: \" + interest_id);\n    }\n\n    return poi;\n  }\n\n  /**\n   * Insère un objet UserMap à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet UserMap que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un UserMap.\n   */\n  static insertUserMapInZoneMaps(\n    model_by_ref: { ref: CompleteModel },\n    value: UserMap,\n    key: { zone_name: string }\n  ) {\n    try {\n      let z = model_by_ref.ref.zones.get(key.zone_name);\n      if (z === undefined) {\n        throw new Error(\"zone inexistante: \" + key.zone_name);\n      }\n      z.maps.set(value.name, value);\n    } catch (err) {\n      return err;\n    }\n  }\n\n  /**\n   * Insère un objet Trail à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet Sentier que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un Sentier.\n   */\n  static insertTrailInUserMap(\n    model_by_ref: { ref: CompleteModel },\n    value: Trail,\n    key: { zone_name: string; usermap_name: string }\n  ) {\n    try {\n      let z = model_by_ref.ref.zones.get(key.zone_name);\n      if (z === undefined) {\n        throw new Error(\"zone inexistante: \" + key.zone_name);\n      }\n\n      let um = z.maps.get(key.usermap_name);\n      if (um === undefined) {\n        throw new Error(\"carte inexistante: \" + key.usermap_name);\n      }\n\n      um.trails.set(value.name, value);\n    } catch (err) {\n      return err;\n    }\n  }\n\n  /**\n   * Insère un objet Coordinate à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet Coordinate que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un Coordinate.\n   */\n  static insertCoordinateInTrail(\n    model_by_ref: { ref: CompleteModel },\n    value: Coordinate,\n    key: { usermap_name: string; zone_name: string; trail_name: string }\n  ) {\n    try {\n      let z = model_by_ref.ref.zones.get(key.zone_name);\n      if (z === undefined) {\n        throw new Error(\"zone inexistante: \" + key.zone_name);\n      }\n      let um = z.maps.get(key.usermap_name);\n      if (um === undefined) {\n        throw new Error(\"carte inexistante: \" + key.usermap_name);\n      }\n\n      let t = um.trails.get(key.trail_name);\n      if (t === undefined) {\n        throw new Error(\"sentier inexistant: \" + key.usermap_name);\n      }\n\n      t.trailCoordinates.push(value);\n    } catch (err) {\n      return err;\n    }\n  }\n\n  /**\n   * Insère un objet InterestPoint à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet InterestPoint que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un InterestPoint.\n   */\n  static insertInterestPointInUserMap(\n    model_by_ref: { ref: CompleteModel },\n    poi: InterestPoint,\n    key: { usermap_name: string; zone_name: string }\n  ) {\n    try {\n      let z = model_by_ref.ref.zones.get(key.zone_name);\n      if (z === undefined) {\n        throw new Error(\"zone inexistante: \" + key.zone_name);\n      }\n\n      let um = z.maps.get(key.usermap_name);\n      if (um === undefined) {\n        throw new Error(\"carte inexistante: \" + key.usermap_name);\n      }\n\n      um.pointsOfInterest.set(poi.name, poi);\n    } catch (err) {\n      return err;\n    }\n  }\n\n  /**\n   * Insère un objet Sentier à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet InterestPointData que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un InterestPointData.\n   */\n  static insertInterestPointDataInInterestPoint(\n    model_by_ref: { ref: CompleteModel },\n    ipd: InterestPointData,\n    key: {\n      usermap_name: string;\n      zone_name: string;\n      interest_point_name: string;\n    }\n  ) {\n    try {\n      let z = model_by_ref.ref.zones.get(key.zone_name);\n      if (z === undefined) {\n        throw new Error(\"zone inexistante: \" + key.zone_name);\n      }\n      let um = z.maps.get(key.usermap_name);\n      if (um === undefined) {\n        throw new Error(\"carte inexistante: \" + key.usermap_name);\n      }\n\n      let poi = um.pointsOfInterest.get(key.interest_point_name);\n      if (poi === undefined) {\n        throw new Error(\n          \"point d'interet inexistant: \" + key.interest_point_name\n        );\n      }\n      poi.data.push(ipd);\n    } catch (err) {\n      return err;\n    }\n  }\n}\n","import { Partner } from \"./partner\";\nimport { Zone } from \"./zonemodel\";\n\n/**\n * Contient l'ensemble du modèle de données dans un objet typescript\n */\nexport class CompleteModel {\n  zones: Map<string, Zone>;\n  partners: Array<Partner>;\n\n  constructor() {\n    this.zones = new Map<string, Zone>();\n    this.partners = new Array<Partner>();\n  }\n\n  toJson() {\n    let jsonObject: any = {};\n    let a: any[] = [];\n    this.zones.forEach((value: Zone) => {\n      a.push(value.toJson());\n    });\n    jsonObject[\"zones\"] = a;\n    jsonObject[\"partners\"] = this.partners;\n\n    return jsonObject;\n  }\n}\n","import { Coordinate } from \"./coordinatemodel\";\nimport { InterestPointData } from \"./interestpointdatamodel\";\n\n/**\n * Les types de points qui sont possible d'utiliser. Nous pourrons appliquer des comportements à l'application en\n * fonction du type de point.\n */\nexport enum InterestType {\n  service = \"service\",\n  summit = \"summit\",\n  view = \"view\",\n  nature = \"nature\",\n  parking = \"parking\",\n  restroom = \"restroom\",\n  camping = \"camping\",\n  telephone = \"telephone\",\n  picnic = \"picnic\",\n  refuge = \"refuge\",\n  hosting = \"hosting\",\n  unknown = \"unknown\",\n}\n\nexport function getInterestType(x: string): InterestType {\n  return (InterestType as any)[x];\n}\n\n/**\n * Modèle de donnée pour un point d'intérêt\n *\n * Relations:\n *   InterestPoint -N---|- UserMap\n *\n *   InterestPoint -|---|- Coordinate\n */\nexport class InterestPoint {\n  // Attributes\n  name: string;\n  description: string;\n  type: InterestType;\n  uri?: string[];\n  active?: boolean;\n  code: string;\n\n  // Relations\n  coordinate: Coordinate;\n  data: Array<InterestPointData>;\n\n  constructor(\n    name: string,\n    description: string,\n    type: InterestType,\n    coordinate: Coordinate,\n    code: string,\n    active = true\n  ) {\n    this.name = name;\n    this.description = description;\n    this.type = type;\n    this.coordinate = coordinate;\n    this.data = new Array<InterestPointData>();\n    this.code = code;\n    this.active = active;\n  }\n\n  /**\n   * Retourne un objet InterestPoint à partir d'un objet UserMap\n   *\n   * params:\n   *   interestPoints: L'attribut 'interestPoint' de la classe 'UserMap'\n   *   sentierName: L'ID du sentier que l'on veut obtenir\n   */\n  static getFromObjectModel(\n    interestPoints: Array<InterestPoint>,\n    interest_id: string\n  ) {\n    var index = interestPoints\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(interest_id);\n    var sentier = interestPoints[index];\n\n    return sentier;\n  }\n\n  static getTypeFromString(type: string) {\n    switch (type) {\n      case \"Parking\":\n        return InterestType.parking;\n      case \"Point de vue\":\n        return InterestType.view;\n      case \"TÃ©lÃ©phone\":\n        return InterestType.telephone;\n      case \"Piquenique\":\n        return InterestType.picnic;\n      case \"Camping rustique\" || \"Camping\":\n        return InterestType.camping;\n      case \"Refuge\":\n        return InterestType.refuge;\n      case \"HÃ©bergement\":\n        return InterestType.hosting;\n      case \"Toilettes\":\n        return InterestType.restroom;\n      default:\n        return InterestType.unknown;\n    }\n  }\n\n  toJson() {\n    let jsonObjectT: any = {};\n    jsonObjectT[\"name\"] = this.name;\n    jsonObjectT[\"description\"] = this.description;\n    jsonObjectT[\"type\"] = this.type;\n    if (this.uri !== undefined) {\n      jsonObjectT[\"uri\"] = this.uri;\n    }\n    jsonObjectT[\"active\"] = this.active;\n    if (this.code !== undefined) {\n      jsonObjectT[\"code\"] = this.code;\n    }\n    jsonObjectT[\"coordinate\"] = this.coordinate;\n    jsonObjectT[\"data\"] = this.data;\n\n    return jsonObjectT;\n  }\n}\n","import { Coordinate } from \"./coordinatemodel\";\nimport { InterestPoint } from \"./interestpointsmodel\";\nimport { Trail } from \"./trailmodel\";\n\n/**\n * Modèle de donnée pour une carte\n *\n * Relations:\n *   UserMap -N---|- Zone\n *\n *   UserMap -|---N- Trail\n *   UserMap -|---N- InterestPoint\n */\nexport class UserMap {\n  // Attributes\n  name: string;\n  map_file: string;\n  topLeftCoordinate: Coordinate;\n  topRightCoordinate: Coordinate;\n  bottomLeftCoordinate: Coordinate;\n  bottomRightCoordinate: Coordinate;\n\n  // Relations\n  trails: Map<string, Trail>;\n  pointsOfInterest: Map<string, InterestPoint>;\n\n  constructor(\n    name: string,\n    map_file: string,\n    topLeftCoordinate: Coordinate,\n    topRightCoordinate: Coordinate,\n    bottomLeftCoordinate: Coordinate,\n    bottomRightCoordinate: Coordinate\n  ) {\n    this.name = name;\n    this.map_file = map_file;\n    this.trails = new Map<string, Trail>();\n    this.pointsOfInterest = new Map<string, InterestPoint>();\n    this.topLeftCoordinate = topLeftCoordinate;\n    this.topRightCoordinate = topRightCoordinate;\n    this.bottomLeftCoordinate = bottomLeftCoordinate;\n    this.bottomRightCoordinate = bottomRightCoordinate;\n  }\n\n  /**\n   * Retourne un objet UserMap à partir d'un objet Zone\n   *\n   * params:\n   *   userMaps: L'attribut 'maps' de la classe 'Zone'\n   *   userMapName: L'ID de la carte que l'on veut obtenir\n   */\n  static getFromObjectModel(usermaps: Array<UserMap>, userMapName: string) {\n    var index = usermaps\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(userMapName);\n    var usermap = usermaps[index];\n\n    return usermap;\n  }\n\n  toJson() {\n    let a: any[] = [];\n\n    let b: any[] = [];\n\n    let jsonObject: any = {};\n    jsonObject[\"name\"] = this.name;\n    jsonObject[\"map_file\"] = this.map_file;\n    jsonObject[\"topLeftCoordinate\"] = this.topLeftCoordinate;\n    jsonObject[\"topRightCoordinate\"] = this.topRightCoordinate;\n    jsonObject[\"bottomLeftCoordinate\"] = this.bottomLeftCoordinate;\n    jsonObject[\"bottomRightCoordinate\"] = this.bottomRightCoordinate;\n    this.trails.forEach((value: Trail) => {\n      a.push(value.toJson());\n    });\n\n    if (a.length !== 0) {\n      jsonObject[\"trails\"] = a;\n    }\n\n    this.pointsOfInterest.forEach((value: InterestPoint) => {\n      b.push(value.toJson());\n    });\n    if (b.length !== 0) {\n      jsonObject[\"pointsOfInterest\"] = b;\n    }\n    return jsonObject;\n  }\n}\n","import { UserMap } from \"./usermapmodel\";\n\n/**\n * Modèle de donnée pour une zone.\n *\n * Relations:\n *   Zone -|---N- UserMap\n */\nexport class Zone {\n  // Attributes\n  _id: string; // nom de la zone\n\n  // Relations\n  maps: Map<string, UserMap>;\n\n  constructor(name: string) {\n    this._id = name;\n    this.maps = new Map<string, UserMap>();\n  }\n\n  toJson() {\n    let a: any[] = [];\n    let jsonObject: any = {};\n    jsonObject[\"_id\"] = this._id;\n    if (this.maps.size !== undefined) {\n      this.maps.forEach((value: UserMap) => {\n        a.push(value.toJson());\n      });\n    }\n\n    jsonObject[\"maps\"] = a;\n\n    return jsonObject;\n  }\n}\n","/**\n * Les types de données qui sont possible d'utiliser.\n */\nexport enum DataType {\n  video = \"video\",\n  image = \"image\",\n  texte = \"texte\",\n}\n\nexport function getDataType(x: string): DataType {\n  return (DataType as any)[x];\n}\n\n/**\n * Modèle de donnée pour les fichiers et le texte associé à un point d'intérêt.\n *\n * Relations:\n *   InterestPointData -N---|-InterestPoint\n */\nexport class InterestPointData {\n  // Attributes\n  type: DataType;\n  data: string;\n\n  constructor(type: DataType, data: string) {\n    this.type = type;\n    this.data = data;\n  }\n}\n","import { Coordinate } from \"./coordinatemodel\";\n\n/**\n * Modèle de donnée pour un Sentier\n *\n * Relations:\n *   Sentier -N---|- UserMap\n *\n *   Sentier -|---N- Coordinate\n */\nexport class Trail {\n  // Attributes\n  name: string;\n  description: string | undefined;\n  difficulty: number;\n  uri?: string[];\n  active?: boolean;\n  color?: string;\n\n  // Relations\n  trailCoordinates: Coordinate[];\n\n  constructor(\n    name: string,\n    description: string | undefined,\n    difficulty: number,\n    active: boolean = true,\n    color = \"black\"\n  ) {\n    this.name = name;\n    this.description = description;\n    this.difficulty = difficulty;\n    this.color = color;\n    this.trailCoordinates = Array<Coordinate>();\n    this.active = active;\n  }\n\n  /** Ajoute un point au sentier */\n  addPoint(point: Coordinate) {\n    this.trailCoordinates.push(point);\n  }\n\n  /**\n   * Retourne un objet Sentier à partir d'un objet UserMap\n   *\n   * params:\n   *   sentiers: L'attribut 'sentiers' de la classe 'UserMap'\n   *   sentierName: L'ID du sentier que l'on veut obtenir\n   */\n  static getFromObjectModel(sentiers: Array<Trail>, sentierName: string) {\n    var index = sentiers\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(sentierName);\n    var sentier = sentiers[index];\n\n    return sentier;\n  }\n\n  toJson() {\n    let jsonObjectT: any = {};\n    jsonObjectT[\"name\"] = this.name;\n    jsonObjectT[\"description\"] = this.description;\n    jsonObjectT[\"difficulty\"] = this.difficulty;\n    if (this.uri !== undefined) {\n      jsonObjectT[\"uri\"] = this.uri;\n    }\n    jsonObjectT[\"active\"] = this.active;\n    if (this.color !== undefined) {\n      jsonObjectT[\"color\"] = this.color;\n    }\n    jsonObjectT[\"trailCoordinates\"] = this.trailCoordinates;\n    return jsonObjectT;\n  }\n}\n","import { Workbook, Worksheet } from \"exceljs\";\nimport { CompleteModel } from \"../models/completemodel\";\nimport { Coordinate } from \"../models/coordinatemodel\";\nimport {\n  getDataType,\n  InterestPointData,\n} from \"../models/interestpointdatamodel\";\nimport { getInterestType, InterestPoint } from \"../models/interestpointsmodel\";\nimport { Partner } from \"../models/partner\";\nimport { Queries } from \"../models/queries\";\nimport { Trail } from \"../models/trailmodel\";\nimport { UserMap } from \"../models/usermapmodel\";\nimport { Zone } from \"../models/zonemodel\";\n\n/** Classe d'intégration avec Excel */\nexport class ImportExcelFile {\n\n  /**\n   * La fonction qui permet définit les sentiers pour l'application à partir des données du client.\n   * @param csv le nom du fichier csv du client qui définit les sentiers ainsi que dans quels fichiers sont les coordonnées.\n   */\n  static async MigrateSentiersDBF(csv: string, xlsx: string) {\n    try {\n      let wb: Workbook = new Workbook();\n      let model = new CompleteModel();\n      let defaultMap = \"default\";\n      const trailID: string[][] = [];\n\n      await wb.csv.readFile(csv);\n\n      const ws = wb.worksheets[0];\n\n      ws.eachRow((row, rowNumber) => {\n        if (rowNumber !== 1) {\n          let zoneString = row.getCell(3).value!.toString();\n\n          // Zone\n          if (!model.zones.has(zoneString))\n            model.zones.set(zoneString, new Zone(zoneString));\n\n          // Carte\n          if (!model.zones.get(zoneString)!.maps.has(defaultMap)) {\n            let insertMap = new UserMap(\n              defaultMap,\n              \"none\",\n              new Coordinate(-1, -1),\n              new Coordinate(-1, -1),\n              new Coordinate(-1, -1),\n              new Coordinate(-1, -1)\n            );\n            Queries.insertUserMapInZoneMaps({ ref: model }, insertMap, {\n              zone_name: zoneString,\n            });\n          }\n\n          // Trail\n          let trailName = row.getCell(2).value!.toString();\n          let trailFile = row.getCell(1).value!.toString();\n          trailID.push([zoneString, trailName, trailFile]);\n\n          let newTrail = new Trail(trailName, \"none\", -1, true);\n\n          Queries.insertTrailInUserMap({ ref: model }, newTrail, {\n            usermap_name: defaultMap,\n            zone_name: zoneString,\n          });\n        }\n      });\n\n      await ImportExcelFile.MigrateServicesData(\"donnees/services.csv\", {\n        ref: model,\n      });\n      await ImportExcelFile.MigrateTrailCoordinate(trailID, { ref: model });\n      let write_success = this.ReverseEngineerWorkbookProgrammatically(\n        \"output.xlsx\",\n        model\n      );\n      return write_success;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  static async MigrateTrailCoordinate(\n    trailID: string[][],\n    model: { ref: CompleteModel }\n  ) {\n    for (const id of trailID) {\n      let wb: Workbook = new Workbook();\n      let csvFile = \"donnees/\".concat(id[2]);\n      await wb.csv.readFile(csvFile);\n      const ws = wb.worksheets[0];\n\n      ws.eachRow((row, rowNumber) => {\n        let longitude = Number(row.getCell(1).value!.toString());\n        let latitude = Number(row.getCell(2).value!.toString());\n        let altitude = Number(row.getCell(3).value!.toString());\n        let c = new Coordinate(longitude, latitude, altitude);\n        model.ref.zones\n          .get(id[0])!\n          .maps.get(\"default\")!\n          .trails.get(id[1])!\n          .trailCoordinates.push(c);\n      });\n    }\n  }\n\n  /**\n   * Méthode pour migrer les données du client vers le fichier Excel d'entrée de données. Le fichier d'entrée doit\n   * etre en CSV.\n   *\n   * @param csv Le nom du fichier duquel on veut extraire les données, en csv.\n   * @param xlsx Le nom du fichier qu'on veut générer avec les données, en xlsx.\n   * @returns write_succesful Un string qui indique si l'écriture du fichier Excel résultant est un succès.\n   */\n  static async MigrateServicesData(\n    csv: string,\n    model_by_ref: { ref: CompleteModel }\n  ) {\n    let defaultMap = \"default\";\n\n    let wb = new Workbook();\n    await wb.csv.readFile(csv);\n\n    const ws = wb.worksheets[0];\n    ws.eachRow((row, rowNumber) => {\n      if (rowNumber !== 1) {\n        let zoneString = row.getCell(4).value!.toString();\n\n        // Zone\n        if (!model_by_ref.ref.zones.has(zoneString))\n          model_by_ref.ref.zones.set(zoneString, new Zone(zoneString));\n\n        // Carte\n        if (!model_by_ref.ref.zones.get(zoneString)!.maps.has(defaultMap)) {\n          let insertMap = new UserMap(\n            defaultMap,\n            \"none\",\n            new Coordinate(-1, -1),\n            new Coordinate(-1, -1),\n            new Coordinate(-1, -1),\n            new Coordinate(-1, -1)\n          );\n          model_by_ref.ref.zones\n            .get(zoneString)!\n            .maps.set(defaultMap, insertMap);\n        }\n\n        // InterestPoint\n        let type = row.getCell(5).value!.toString();\n        let poiName = row.getCell(2).value!.toString();\n        let altitude = row.getCell(3).value!.toString();\n        let longitude = row.getCell(18).value!.toString();\n        let latitude = row.getCell(19).value!.toString();\n        let insertedType = InterestPoint.getTypeFromString(type);\n\n        let newPOI = new InterestPoint(\n          poiName,\n          \"none\",\n          insertedType,\n          new Coordinate(Number(longitude), Number(latitude), Number(altitude)),\n          \"none\",\n          true\n        );\n\n        model_by_ref.ref.zones\n          .get(zoneString)!\n          .maps.get(defaultMap)!\n          .pointsOfInterest.set(poiName, newPOI);\n      }\n    });\n  }\n\n  /**\n   * Méthode pour aller chercher des données à partir d'un fichier Excel.\n   * Fonctionne pour le panneau de contrôle administrateur\n   *\n   * @param file Le fichier duquel on veut extraire les données.\n   * @returns un objet CompleteModel.\n   */\n  static async fetchDataFromExcel(filename: string) {\n    let wb: Workbook = new Workbook();\n    let model = new CompleteModel();\n    let model_by_ref = { ref: model };\n    let separator = \", \";\n\n    await wb.xlsx.readFile(filename);\n\n    await this.parseExcelFile(wb, model, model_by_ref, separator);\n\n    return model;\n  }\n\n  /**\n   * Prends les informations du fichier Excel d'entrée de données et les ajoute à un objet CompleteModel.\n   *\n   * @param wb un objet ExcelJS.Workbook qui contient les données que le client veut ajouter à l'application.\n   * @param model un objet CompleteModel dans lequel on veut insérer les nouvelles données.\n   * @param model_by_ref un pointeur vers le deuxième paramètre qui permet d'entrer des données dans le modèle à partir\n   * des fonctions appelées par parseExcelFile()\n   * @param separator la chaine de caractère utilisée pour séparer les clés naturelles des entitées dépendantes dans le\n   * fichier Excel.\n   */\n  private static async parseExcelFile(\n    wb: Workbook,\n    model: CompleteModel,\n    model_by_ref: { ref: CompleteModel },\n    separator: string\n  ) {\n    try {\n      // Zone\n      const ws_Zone = wb.getWorksheet(\"Zones\");\n      ws_Zone.eachRow(function (row, rowNumber) {\n        if (rowNumber !== 1) {\n          let cellvalue = row.getCell(1).value!.toString();\n          let z = new Zone(cellvalue);\n          model.zones.set(z._id, z);\n        }\n      });\n\n      // UserMap\n      const ws_UserMap = wb.getWorksheet(\"Carte\");\n      ws_UserMap.eachRow(\n        await async function (row, rowNumber) {\n          if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n            let key = {\n              zone_name: row.getCell(1).value!.toString(),\n            };\n            let usermap_name = row.getCell(2).value!.toString();\n            let filepath = row.getCell(3).value!.toString();\n\n            let tlLong = undefined;\n            let tlLat = undefined;\n            let trLong = undefined;\n            let trLat = undefined;\n            let blLong = undefined;\n            let blLat = undefined;\n            let brLong = undefined;\n            let brLat = undefined;\n\n            if (row.getCell(4).value)\n              tlLong = Number(row.getCell(4).value!.toString());\n            if (row.getCell(5).value)\n              tlLat = Number(row.getCell(5).value!.toString());\n            if (row.getCell(6).value)\n              trLong = Number(row.getCell(6).value!.toString());\n            if (row.getCell(7).value)\n              trLat = Number(row.getCell(7).value!.toString());\n            if (row.getCell(8).value)\n              blLong = Number(row.getCell(8).value!.toString());\n            if (row.getCell(9).value)\n              blLat = Number(row.getCell(9).value!.toString());\n            if (row.getCell(10).value)\n              brLong = Number(row.getCell(10).value!.toString());\n            if (row.getCell(11).value)\n              brLat = Number(row.getCell(11).value!.toString());\n\n            let um = new UserMap(\n              usermap_name,\n              filepath,\n              new Coordinate(tlLong, tlLat),\n              new Coordinate(trLong, trLat),\n              new Coordinate(blLong, blLat),\n              new Coordinate(brLong, brLat)\n            );\n\n            Queries.insertUserMapInZoneMaps(model_by_ref, um, key);\n          }\n        }\n      );\n\n      // Trail\n      const ws_Trail = wb.getWorksheet(\"Sentier\");\n      ws_Trail.eachRow(\n        await async function (row, rowNumber) {\n          if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n            let keyCell = row.getCell(1).value!.toString().split(separator);\n\n            let key = {\n              zone_name: keyCell[0],\n              usermap_name: keyCell[1],\n            };\n\n            let trailDescription = undefined;\n            let difficulty = 1;\n            let color = \"black\";\n            let active = true;\n\n            let trailName = row.getCell(2).value!.toString();\n            if (row.getCell(3).value) {\n              trailDescription = row.getCell(3).value!.toString();\n            }\n            if (row.getCell(4).value) {\n              difficulty = Number(row.getCell(4).value!.toString());\n            }\n            if (row.getCell(5).value) {\n              color = row.getCell(5).value!.toString();\n            }\n            if (row.getCell(6)) {\n              active = row.getCell(6).value!.valueOf() as boolean;\n            }\n\n            let s = new Trail(\n              trailName,\n              trailDescription,\n              difficulty,\n              active,\n              color\n            );\n\n            Queries.insertTrailInUserMap(model_by_ref, s, key);\n          }\n        }\n      );\n\n      // Coordonnées de sentiers\n      const ws_coordinateSentier = wb.getWorksheet(\"Coordonnees de Sentier\");\n      ws_coordinateSentier.eachRow(\n        await async function (row, rowNumber) {\n          if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n            let keyCell = row.getCell(1).value!.toString().split(separator);\n\n            let key = {\n              zone_name: keyCell[0],\n              usermap_name: keyCell[1],\n              trail_name: keyCell[2],\n            };\n\n            let longitude = undefined;\n            let latitude = undefined;\n            let altitude = undefined;\n\n            if (row.getCell(2).value)\n              longitude = Number(row.getCell(2).value!.toString());\n            if (row.getCell(3).value)\n              latitude = Number(row.getCell(3).value!.toString());\n            if (row.getCell(4).value)\n              altitude = Number(row.getCell(4).value!.toString());\n\n            let c = new Coordinate(longitude, latitude, altitude);\n\n            Queries.insertCoordinateInTrail(model_by_ref, c, key);\n          }\n        }\n      );\n\n      // Point d'interet\n      const ws_interestPoints = wb.getWorksheet(\"Point d'interet\");\n      ws_interestPoints.eachRow(\n        await async function (row, rowNumber) {\n          if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n            let keyCell = row.getCell(1).value!.toString().split(separator);\n\n            let key = {\n              zone_name: keyCell[0],\n              usermap_name: keyCell[1],\n            };\n\n            let poiTypeString = \"unknown\";\n            let description = \"\";\n            let poiLong = undefined;\n            let poiLat = undefined;\n            let active = true;\n\n            let poiName = row.getCell(2).value!.toString();\n            if (row.getCell(3).value)\n              description = row.getCell(3).value!.toString();\n\n            if (row.getCell(4).value)\n              poiTypeString = row.getCell(4).value!.toString();\n            let it = getInterestType(poiTypeString);\n\n            if (row.getCell(5))\n              active = row.getCell(5).value!.valueOf() as boolean;\n\n            if (row.getCell(6))\n              poiLong = Number(row.getCell(6).value!.toString());\n            if (row.getCell(7))\n              poiLat = Number(row.getCell(7).value!.toString());\n\n            let ip = new InterestPoint(\n              poiName,\n              description,\n              it,\n              new Coordinate(poiLong, poiLat),\n              \"code\",\n              active\n            );\n\n            Queries.insertInterestPointInUserMap(model_by_ref, ip, key);\n          }\n        }\n      );\n\n      // Données d'un point d'interet\n      const ws_interestPointsData = wb.getWorksheet(\n        \"Fichiers de point d'interet\"\n      );\n      ws_interestPointsData.eachRow(async function (row, rowNumber) {\n        if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n          let keyCell = row.getCell(1).value!.toString().split(separator);\n\n          let key = {\n            zone_name: keyCell[0],\n            usermap_name: keyCell[1],\n            interest_point_name: keyCell[2],\n          };\n\n          let ipd_type = row.getCell(2).value!.toString();\n          let datatype = getDataType(ipd_type);\n\n          let ipd_data = row.getCell(3).value!.toString();\n\n          let ip = new InterestPointData(datatype, ipd_data);\n\n          Queries.insertInterestPointDataInInterestPoint(model_by_ref, ip, key);\n        }\n      });\n\n      // Partners\n      const ws_Partners = wb.getWorksheet(\"Partners\");\n      ws_Partners.eachRow(\n        await async function (row, rowNumber) {\n          if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n            let p = new Partner(row.getCell(1).toString());\n            if (row.getCell(2).value) p.uri = row.getCell(2).toString();\n            model.partners.push(p);\n          }\n        }\n      );\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  /**\n   * Méthode pour aller chercher des données à partir d'un fichier Excel.\n   * Fonctionne pour le panneau de contrôle administrateur\n   *\n   * @param file Le fichier duquel on veut extraire les données.\n   * @returns un objet CompleteModel.\n   */\n  static async fetchDataFromExcelFromBrowser(file: File) {\n    const Excel = require(\"exceljs\");\n    let wb: Workbook = new Excel.Workbook();\n    let model = new CompleteModel();\n    let model_by_ref = { ref: model };\n    let separator = \", \";\n\n    // @ts-ignore\n    let arrayBuff = await file.arrayBuffer();\n    let buffer = await ImportExcelFile.toBuffer(arrayBuff);\n    try {\n      return Promise.resolve(\n        await wb.xlsx.load(buffer).then(async (book) => {\n          try {\n            // Zone\n            await this.parseExcelFile(book, model, model_by_ref, separator);\n          } catch (err) {\n            console.log(err);\n            return Promise.resolve(new CompleteModel());\n          }\n          return Promise.resolve(model);\n        })\n      );\n    } catch (err) {\n      console.log(err);\n      return Promise.resolve(new CompleteModel());\n    }\n  }\n\n  /**\n   * Produit un Buffer à partir d'un objet 'ArrayBuffer'.\n   *\n   * @param model L'objet 'ArrayBuffer'.\n   * @returns un Buffer.\n   */\n  static async toBuffer(ab: ArrayBuffer) {\n    let buf = Buffer.alloc(ab.byteLength);\n    let view = new Uint8Array(ab);\n    for (var i = 0; i < buf.length; ++i) {\n      buf[i] = view[i];\n    }\n    return buf;\n  }\n\n  /**\n   * Produit un fichier Excel à partir d'un objet 'CompleteModel'.\n   *\n   * @param filename Le nom que l'on veut donner à notre feuille Excel.\n   * @param model L'objet 'CompleteModel' à insérer dans une feuille Excel.\n   * @returns \"write succesful\" si la méthode n'a pas rencontré d'erreur.\n   */\n  static async ReverseEngineerWorkbookProgrammatically(\n    filename: string,\n    model: CompleteModel\n  ) {\n    const wb: Workbook = new Workbook();\n\n    /** # general info */\n    wb.creator = \"Sentiers de l'Estrie\";\n    wb.created = new Date();\n\n    /** # make sheets */\n    const key_sheet = wb.addWorksheet(\"Keys\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const zone_sheet = wb.addWorksheet(\"Zones\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const usermap_sheet = wb.addWorksheet(\"Carte\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const sentier_sheet = wb.addWorksheet(\"Sentier\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const coordinateSentier_sheet = wb.addWorksheet(\"Coordonnees de Sentier\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const interestPoint_sheet = wb.addWorksheet(\"Point d'interet\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const interestPointData_sheet = wb.addWorksheet(\n      \"Fichiers de point d'interet\",\n      { views: [{ state: \"frozen\", ySplit: 1 }] }\n    );\n    const partners_sheet = wb.addWorksheet(\"Partners\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n\n    /** ## make tables within spreadsheets that contain row names, column names, data */\n    let ExcelModel = this.FormatModelToExcel(model);\n    let ColumnsModel = this.MakeColumnsMap();\n\n    this.addTableWrapper(\n      zone_sheet,\n      \"tableau_zones\",\n      ColumnsModel,\n      ExcelModel,\n      \"zones\"\n    );\n    this.addTableWrapper(\n      usermap_sheet,\n      \"tableau_cartes\",\n      ColumnsModel,\n      ExcelModel,\n      \"user_maps\"\n    );\n    this.addTableWrapper(\n      sentier_sheet,\n      \"tableau_sentiers\",\n      ColumnsModel,\n      ExcelModel,\n      \"sentiers\"\n    );\n    this.addTableWrapper(\n      coordinateSentier_sheet,\n      \"tableau_coordinateSentiers\",\n      ColumnsModel,\n      ExcelModel,\n      \"coordinate_sentiers\"\n    );\n    this.addTableWrapper(\n      interestPoint_sheet,\n      \"tableau_interestPoint\",\n      ColumnsModel,\n      ExcelModel,\n      \"interest_points\"\n    );\n    this.addTableWrapper(\n      interestPointData_sheet,\n      \"tableau_interestPointData\",\n      ColumnsModel,\n      ExcelModel,\n      \"interest_points_data\"\n    );\n    this.addTableWrapper(\n      partners_sheet,\n      \"tableau_partners\",\n      ColumnsModel,\n      ExcelModel,\n      \"partners\"\n    );\n\n    /** # Data validation */\n    /** ## Configure single key as defined name */\n    zone_sheet\n      .getColumn(\"A\")\n      .eachCell({ includeEmpty: true }, function (cell, rowNumber) {\n        if (rowNumber !== 1) {\n          cell.name = \"Zone_ID\";\n        }\n      });\n\n    /** ## Configure composite keys sheet */\n    let separator = '\", \"';\n    // @ts-ignore\n    wb.definedNames.addFormula(\n      \"CONCATENATE(tableau_cartes[ID: Zone],\" +\n        separator +\n        \",tableau_cartes[ID: Nom])\",\n      \"Cartes_PK\"\n    );\n    // @ts-ignore\n    wb.definedNames.addFormula(\n      \"CONCATENATE(tableau_sentiers[ID: Zone, Carte],\" +\n        separator +\n        \",tableau_sentiers[ID: Nom])\",\n      \"Sentier_PK\"\n    );\n    // @ts-ignore\n    wb.definedNames.addFormula(\n      \"CONCATENATE(tableau_interestPoint[ID: Zone, Carte],\" +\n        separator +\n        \",tableau_interestPoint[ID: Nom])\",\n      \"PointInteret_PK\"\n    );\n\n    //keys\n    key_sheet.getCell(\"A1\").value = \"Cartes_PK\";\n    key_sheet.getCell(\"A2\").value = \"=Cartes_PK\";\n\n    key_sheet.getCell(\"B1\").value = \"Sentier_PK\";\n    key_sheet.getCell(\"B2\").value = \"=Sentier_PK\";\n\n    key_sheet.getCell(\"C1\").value = \"PointInteret_PK\";\n    key_sheet.getCell(\"C2\").value = \"=PointInteret_PK\";\n\n    /** # Add validation to first column */\n    this.dataValidationWrapper(\n      usermap_sheet,\n      \"Zone_ID\",\n      \"'ID: Zone'\",\n      \"'Zone'\"\n    );\n    this.dataValidationWrapper(\n      sentier_sheet,\n      \"Keys!A:A\",\n      \"'ID: Zone', 'ID: Nom'\",\n      \"'Carte'\"\n    );\n    this.dataValidationWrapper(\n      coordinateSentier_sheet,\n      \"Keys!B:B\",\n      \"'ID: Carte', 'ID: Nom'\",\n      \"'Sentier'\"\n    );\n    this.dataValidationWrapper(\n      interestPoint_sheet,\n      \"Keys!A:A\",\n      \"'ID: Zone', 'ID: Nom'\",\n      \"'Carte'\"\n    );\n    this.dataValidationWrapper(\n      interestPointData_sheet,\n      \"Keys!C:C\",\n      \"'ID: Sentier', 'ID: Nom'\",\n      \"'Point d'interet'\"\n    );\n\n    await wb.xlsx.writeFile(filename);\n\n    return \"write succesful\";\n  }\n\n  /**\n   * Abstraction pour ajouter un 'table Excel' contenant les données dans un fichier Excel\n   * @param sheet Une feuille du fichier Excel.\n   * @param table_name Nom à attribuer à la table.\n   * @param columns Le nom donné à chaque colonne de l'entité 'table Excel'.\n   * @param excel_model La map des colonnes pour chaque feuille Excel.\n   * @param model_key La clé du paramètre 'excel_model' pour obtenir les colonnes à ajouter au 'table Excel'.\n   */\n  private static addTableWrapper(\n    sheet: Worksheet,\n    table_name: string,\n    columns: any,\n    excel_model: Map<any, any>,\n    model_key: string\n  ) {\n    sheet.addTable({\n      name: table_name,\n      ref: \"A1\",\n      headerRow: true,\n      style: {\n        theme: \"TableStyleDark3\",\n        showRowStripes: true,\n      },\n      columns: columns.get(model_key),\n      rows: excel_model.get(model_key),\n    });\n    this.makeColumnsPretty(sheet);\n  }\n\n  /** Création statique de la définition des colonnes pour les 'tables Excel'. */\n  private static MakeColumnsMap() {\n    let ColumnsMap = new Map();\n\n    let zone_columns = [{ name: \"ID: Nom\", filterButton: true }];\n\n    let usermap_columns = [\n      { name: \"ID: Zone\", filterButton: true },\n      { name: \"ID: Nom\", filterButton: true },\n      { name: \"Path\", filterButton: true },\n      { name: \"Coin gauche sup. longitude\", filterButton: true },\n      { name: \"Coin gauche sup. latitude\", filterButton: true },\n      { name: \"Coin droit sup. longitude\", filterButton: true },\n      { name: \"Coin droit sup. latitude\", filterButton: true },\n      { name: \"Coin gauche inf. longitude\", filterButton: true },\n      { name: \"Coin gauche inf. latitude\", filterButton: true },\n      { name: \"Coin droit inf. longitude\", filterButton: true },\n      { name: \"Coin droit inf. latitude\", filterButton: true },\n    ];\n\n    let sentier_columns = [\n      { name: \"ID: Zone, Carte\", filterButton: true },\n      { name: \"ID: Nom\", filterButton: true },\n      { name: \"Description\", filterButton: true },\n      { name: \"Difficultée\", filterButton: true },\n      { name: \"Couleur du sentier\", filterButton: true },\n      { name: \"Active\", filterButton: true },\n    ];\n\n    let trailCoordinates_columns = [\n      { name: \"ID: Zone, Carte, Sentier\", filterButton: true },\n      { name: \"Longitude\", filterButton: true },\n      { name: \"Latitude\", filterButton: true },\n      { name: \"Altitude\", filterButton: true },\n    ];\n\n    let interestPoint_columns = [\n      { name: \"ID: Zone, Carte\", filterButton: true },\n      { name: \"ID: Nom\", filterButton: true },\n      { name: \"Description\", filterButton: true },\n      { name: \"Type d'intérêt\", filterButton: true },\n      { name: \"Active\", filterButton: true },\n      { name: \"Longitude\", filterButton: true },\n      { name: \"Latitude\", filterButton: true },\n    ];\n\n    let interestPointData_columns = [\n      { name: \"ID: Point d'interet\", filterButton: true },\n      { name: \"Type de donnee\", filterButton: true },\n      { name: \"Donnee\", filterButton: true },\n    ];\n\n    let partners_columns = [\n      { name: \"nom\", filterButton: true },\n      { name: \"uri\", filterButton: true },\n    ];\n\n    ColumnsMap.set(\"zones\", zone_columns);\n    ColumnsMap.set(\"user_maps\", usermap_columns);\n    ColumnsMap.set(\"sentiers\", sentier_columns);\n    ColumnsMap.set(\"coordinate_sentiers\", trailCoordinates_columns);\n    ColumnsMap.set(\"interest_points\", interestPoint_columns);\n    ColumnsMap.set(\"interest_points_data\", interestPointData_columns);\n    ColumnsMap.set(\"partners\", partners_columns);\n\n    return ColumnsMap;\n  }\n\n  /**\n   * Insère les lignes de Excel dans un objet CompleteModel.\n   * @param model Un objet CompleteModel.\n   * @returns Un objet CompleteModel.\n   */\n  static FormatModelToExcel(model: CompleteModel) {\n    const separator = \", \";\n    let ExcelModel = new Map();\n\n    const zoneRows: string[][] = [];\n    const usermapRows: any[][] = [];\n    const sentierRows: any[][] = [];\n    const coordinateSentierRows: any[][] = [];\n    const interestPointRows: any[][] = [];\n    const interestPointDataRows: any[][] = [];\n    const partnersRows: any[][] = [];\n\n    model.zones.forEach(function (zone) {\n      zoneRows.push([zone._id]);\n\n      zone.maps.forEach(function (usermap) {\n        usermapRows.push([\n          zone._id,\n          usermap.name,\n          usermap.map_file,\n          usermap.topLeftCoordinate.longitude,\n          usermap.topLeftCoordinate.latitude,\n          usermap.topRightCoordinate.longitude,\n          usermap.topRightCoordinate.latitude,\n          usermap.bottomLeftCoordinate.longitude,\n          usermap.bottomLeftCoordinate.latitude,\n          usermap.bottomRightCoordinate.longitude,\n          usermap.bottomRightCoordinate.latitude,\n        ]);\n\n        usermap.trails.forEach(function (trail) {\n          sentierRows.push([\n            zone._id + separator + usermap.name,\n            trail.name,\n            trail.description,\n            trail.difficulty,\n            trail.color,\n            trail.active,\n          ]);\n\n          trail.trailCoordinates.forEach(function (point) {\n            coordinateSentierRows.push([\n              zone._id + separator + usermap.name + separator + trail.name,\n              point.longitude,\n              point.latitude,\n              point.altitude,\n            ]);\n          });\n        });\n\n        usermap.pointsOfInterest.forEach(function (interest_point) {\n          interestPointRows.push([\n            zone._id + separator + usermap.name,\n            interest_point.name,\n            interest_point.description,\n            interest_point.type,\n            interest_point.active,\n            interest_point.coordinate.longitude,\n            interest_point.coordinate.latitude,\n          ]);\n\n          interest_point.data.forEach(function (interest_point_data) {\n            interestPointDataRows.push([\n              zone._id +\n              separator +\n              usermap.name +\n              separator +\n              interest_point.name,\n              interest_point_data.type,\n              interest_point_data.data,\n            ]);\n          });\n        });\n      });\n    });\n\n    model.partners.forEach(function (partner) {\n      partnersRows.push([partner.name, partner.uri]);\n    });\n\n    if (interestPointDataRows.length === 0)\n      interestPointDataRows.push([\n        \"Bolton, default, Lac Trousers\",\n        \"image\",\n        \"img\",\n      ]);\n\n    if (partnersRows.length === 0) partnersRows.push([\"exemple\", \"exemple\"]);\n\n    ExcelModel.set(\"zones\", zoneRows);\n    ExcelModel.set(\"user_maps\", usermapRows);\n    ExcelModel.set(\"sentiers\", sentierRows);\n    ExcelModel.set(\"coordinate_sentiers\", coordinateSentierRows);\n    ExcelModel.set(\"interest_points\", interestPointRows);\n    ExcelModel.set(\"interest_points_data\", interestPointDataRows);\n    ExcelModel.set(\"partners\", partnersRows);\n\n    return ExcelModel;\n  }\n\n  /**\n   * Ajuste la longueur des colonnes\n   * @param sheet Une feuille du fichier Excel.\n   */\n  static makeColumnsPretty(sheet: Worksheet) {\n    sheet.columns.forEach((column) => {\n      var maxLength = 0;\n      // @ts-ignore\n      column.eachCell({ includeEmpty: true }, function (cell, rowNumber) {\n        var columnLength = cell.value ? cell.value.toString().length : 10;\n        if (columnLength > maxLength) {\n          maxLength = columnLength;\n        }\n      });\n      column.width = maxLength < 10 ? 10 : maxLength;\n    });\n  }\n\n  /**\n   * Abstraction pour ajouter une validation des données à la première colonne d'une feuille Excel\n   * @param sheet Une feuille du fichier Excel.\n   * @param formula La formule en VBA pour la validation des données.\n   * @param foreign_key Spécifie à l'utilisateur quelles colonnes composent la clé étrangère de cette feuille.\n   * @param feuille Spécifie à l'utilisateur l'entitée parente de cette feuille, le lien de dépendance.\n   */\n  private static dataValidationWrapper(\n    sheet: Worksheet,\n    formula: string,\n    foreign_key: string,\n    feuille: string\n  ) {\n    sheet\n      .getColumn(\"A\")\n      .eachCell({ includeEmpty: true }, function (cell, rowNumber) {\n        if (rowNumber !== 1) {\n          cell.dataValidation = {\n            type: \"list\",\n            allowBlank: true,\n            showInputMessage: true,\n            formulae: [formula],\n            // showErrorMessage: true,\n            promptTitle: \"Foreign Key\",\n            prompt:\n              \"La valeur doit être présente dans la colonne \" +\n              foreign_key +\n              \" de la feuille \" +\n              feuille +\n              \".\",\n          };\n        }\n      });\n  }\n}","/**\n * Structure de donnees pour définir des partenaires qui seront affichés à l'écran de connection.\n * */\nexport class Partner {\n    name: string;\n    uri: string | undefined;\n\n    constructor(name: string, uri: string | undefined = undefined) {\n        this.name = name;\n        this.uri = uri;\n    }\n}"],"sourceRoot":""}