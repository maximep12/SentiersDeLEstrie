{"version":3,"sources":["models/queries.ts","Assets/logoSentiersEstrie.png","Assets/logoUniversiteSherbrooke.png","DesktopViews/DownloadLastFile.ts","Utils/colors.ts","DesktopComponents/LastUsedExcel/LastUsedExcel.tsx","DesktopComponents/Button/SentiersButton.tsx","DesktopComponents/Preview/Styles.tsx","DesktopComponents/PreviewInterestPoint/PreviewInterestPoint.tsx","DesktopComponents/PreviewTrail/PreviewTrail.tsx","DesktopComponents/PreviewMap/PreviewMap.tsx","DesktopComponents/PreviewZone/PreviewZone.tsx","DesktopComponents/Preview/Preview.tsx","DesktopViews/PreviewView.ts","DesktopViews/UpdateView.ts","DesktopControllers/UpdateAppMap.tsx","Assets/sentiersImages.ts","Utils/HeaderSentier.tsx","App.tsx","reportWebVitals.js","index.js","Utils/DatabaseUtils.ts","models/completemodel.ts","models/coordinatemodel.ts","models/zonemodel.ts","models/interestpointsmodel.ts","models/usermapmodel.ts","models/trailmodel.ts","models/interestpointdatamodel.ts","Utils/ImportExcelFile.ts"],"names":["Queries","model","CompleteModel","db","PouchDB","DatabaseUtils","getProdDB","options","include_docs","attachments","doc","allDocs","console","log","close","rows","s","e","Zone","get","_id","z","zones","push","zoneName","getFromObjectModel","userMapName","zone","UserMap","maps","sentierName","usermap","Trail","trails","interest_id","InterestPoint","pointsOfInterest","model_by_ref","value","key","zoneIndex","ref","map","x","indexOf","zone_name","usermapIndex","name","usermap_name","c","sentierIndex","sentier_name","trailCoordinates","ip","ipd","interest_pointIndex","interest_point_name","data","getLastUpdatedDate","a","getDateFromAppStatus","colors","LastUsedExcel","useState","lastUpdadedDate","setLastUpdadedDate","useEffect","className","style","backgroundColor","borderColor","marginTop","MyButtonTypes","SentiersButton","text","type","color","hover","textColor","textColorHover","icon","onClick","isHover","setIsHover","stateBackground","setBackgroundColor","stateColor","setStateColor","onMouseOver","onMouseLeave","marginRight","useStyles","makeStyles","theme","normalText","fontWeight","padding","headings","margin","title","display","fontSize","rowNotColored","rowColored","circularProgress","accordionElement","width","border","borderRadius","marginBottom","contentAligner","flexDirection","preview","accordionDoubleElement","root","expandIcon","PreviewInterestPoint","zoneId","mapId","interestPointName","itemNumber","premiseInterestPoint","setInterestPoint","classes","poi","getInterestPointsFromObjectModel","coordinate","longitude","latitude","PreviewTrail","trailName","premiseTrail","setTrail","t","getSentierFromObjectModel","difficulty","PreviewMap","premiseMapId","setMapId","setTrails","interestPoints","setIterestPoints","m","getUserMapFromObjectModel","Accordion","AccordionSummary","aria-controls","id","AccordionDetails","length","trail","index","interestPoint","PreviewZone","premiseZoneId","setZoneId","setMaps","getZoneFromObjectModel","Preview","setModel","setZones","CircularProgress","sendForPreview","excel","destroy","err","defaultModel","isSent","Promise","resolve","ImportExcelFile","fetchDataFromExcel","undefined","doneModel","sendForUpdate","sendModelToServer","error","deleteLocalDB","warn","SendingState","ErrorMessages","UpdateAppMap","visibilityToggle","receivedFile","setFile","displayPreview","setDisplayPreview","fileName","setFileName","aFileWasAdded","setAFileWasAdded","modelRecieved","message","none","sendingState","UNKNOWN","errorMessage","setErrorMessage","sendForPreviewOnClick","file","response","failedToParse","ERROR","cancelUpdateOnClick","failedToDeleteDB","WARNING","sendForUpdateOnClick","succeedToSend","SUCCESS","failedToSend","alignItems","accept","required","event","target","onChange","files","item","split","pop","notAnExcel","missingFile","small","faFileImport","document","getElementById","click","fontStyle","marginLeft","Alert","severity","large","medium","images","logoSentiersEstrie","require","logoUniversiteSherbrooke","Header","src","default","alt","unstable_createMuiStrictModeTheme","App","isVisible","setIsVisibile","ThemeProvider","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","referrer","match","window","location","replace","StrictMode","postRequestToServer","JSON","stringify","toSend","isExcel","formdata","destinationUri","FormData","append","requestHeaders","Accept","requestOptions","method","headers","body","fetch","status","this","Array","Coordinate","altitude","post","InterestType","getInterestType","description","code","dateDebut","dateFin","uri","activeWindow","parking","view","telephone","picnic","camping","refuge","hosting","restroom","unknown","map_file","sentiers","topLeftCoordinate","topRightCoordinate","bottomLeftCoordinate","bottomRightCoordinate","usermaps","point","DataType","getDataType","InterestPointData","csv","xlsx","wb","Workbook","defaultMap","readFile","worksheets","eachRow","row","rowNumber","zoneString","getCell","toString","insertMap","insertUserMapInZoneMaps","poiName","insertedType","getTypeFromString","newPOI","Number","insertInterestPointInUserMap","write_success","ReverseEngineerWorkbookProgrammatically","Excel","separator","arrayBuffer","arrayBuff","toBuffer","buffer","load","book","getWorksheet","zone_maps","cellvalue","ws_UserMap","interest_points","filepath","tlLong","tlLat","trLong","trLat","blLong","blLat","brLong","brLat","um","ws_Trail","keyCell","trailDescription","dateDebutString","day","substr","month","Date","dateFinString","insertSentierInUserMap","ws_coordinateSentier","insertCoordinateInSentier","ws_interestPoints","poiTypeString","poiLong","poiLat","it","ws_interestPointsData","ipd_type","datatype","ipd_data","insertInterestPointDataInInterestPoint","ab","buf","Buffer","alloc","byteLength","Uint8Array","i","filename","creator","created","key_sheet","addWorksheet","views","state","ySplit","zone_sheet","usermap_sheet","sentier_sheet","coordinateSentier_sheet","interestPoint_sheet","interestPointData_sheet","ExcelModel","FormatModelToExcel","ColumnsModel","MakeColumnsMap","addTableWrapper","getColumn","eachCell","includeEmpty","cell","definedNames","addFormula","dataValidationWrapper","writeFile","sheet","table_name","columns","excel_model","model_key","addTable","headerRow","showRowStripes","makeColumnsPretty","ColumnsMap","Map","set","filterButton","zoneRows","usermapRows","sentierRows","coordinateSentierRows","interestPointRows","interestPointDataRows","forEach","debutDate","finDate","debutDateDayNumber","getDate","debutDateMonthNumber","getMonth","finDateDayNumber","finDateMonthNumber","FormatDateNumbersToString","interest_point","interest_point_data","column","maxLength","columnLength","formula","foreign_key","feuille","dataValidation","allowBlank","showInputMessage","formulae","promptTitle","prompt","dateDayNumber","dateMonthNumber"],"mappings":"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","file":"static/js/main.1044210e.chunk.js","sourcesContent":["import PouchDB from \"pouchdb\";\nimport { DatabaseUtils } from \"../Utils/DatabaseUtils\";\nimport { CompleteModel } from \"./completemodel\";\nimport { Coordinate } from \"./coordinatemodel\";\nimport { InterestPointData } from \"./interestpointdatamodel\";\nimport { InterestPoint } from \"./interestpointsmodel\";\nimport { Trail } from \"./trailmodel\";\nimport { UserMap } from \"./usermapmodel\";\nimport { Zone } from \"./zonemodel\";\n\n/**\n * Classe pour écrire des requêtes noSQL\n */\nexport class Queries {\n  /**\n   * Rempli un objet CompleteModel vide à partir des documents noSQL.\n   *\n   * @param model Une instance vide de CompleteModel.\n   */\n  static async getAllDocumentsAsObjects(): Promise<CompleteModel> {\n    var model = new CompleteModel();\n\n    var db = new PouchDB(DatabaseUtils.getProdDB());\n\n    var options = {\n      include_docs: true,\n      attachments: true,\n    };\n\n    var doc = null;\n    try {\n      doc = await db.allDocs(options);\n    } catch (err) {\n      console.log(err);\n    } finally {\n      await db.close();\n    }\n\n    for (let e of doc!.rows) {\n      var z = await Zone.get(e.doc!._id);\n      model.zones.push(z);\n    }\n\n    return model;\n  }\n\n  /**\n   * Retourne un objet Zone à partir du modèle objet complet.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone que l'on veut obtenir.\n   * @returns un objet Zone.\n   */\n  static getZoneFromObjectModel(model: CompleteModel, zoneName: string) {\n    return Zone.getFromObjectModel(model.zones, zoneName);\n  }\n\n  /**\n   * Retourne un objet UserMap à partir d'un objet CompleteModel.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone contenant le UserMap.\n   * @param userMapName L'ID de la carte contenannt le UserMap.\n   * @returns un objet UserMap.\n   */\n  static getUserMapFromObjectModel(\n    model: CompleteModel,\n    zoneName: string,\n    userMapName: string\n  ) {\n    var zone = Zone.getFromObjectModel(model.zones, zoneName);\n    return UserMap.getFromObjectModel(zone.maps, userMapName);\n  }\n\n  /**\n   * Retourne un objet Sentier à partir d'un objet CompleteModel.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone contenant le sentier.\n   * @param userMapName L'ID de la carte contenant le sentier.\n   * @param sentierName L'ID du sentier que l'on veut obtenir.\n   * @returns un objet Sentier.\n   */\n  static getSentierFromObjectModel(\n    model: CompleteModel,\n    zoneName: string,\n    userMapName: string,\n    sentierName: string\n  ) {\n    var zone = Zone.getFromObjectModel(model.zones, zoneName);\n    var usermap = UserMap.getFromObjectModel(zone.maps, userMapName);\n    return Trail.getFromObjectModel(usermap.trails, sentierName);\n  }\n\n  /**\n   * Retourne un objet InterestPoint à partir d'un objet CompleteModel.\n   *\n   * @param model Le modèle de donnée complet en objet.\n   * @param zoneName L'ID de la zone contenant le point d'interet.\n   * @param userMapName L'ID de la carte contenant le point d'interet.\n   * @param interest_id L'ID du point d'interet que l'on veut.\n   * @returns un objet InterestPoint.\n   */\n  static getInterestPointsFromObjectModel(\n    model: CompleteModel,\n    zoneName: string,\n    userMapName: string,\n    interest_id: string\n  ) {\n    var zone = Zone.getFromObjectModel(model.zones, zoneName);\n    var usermap = UserMap.getFromObjectModel(zone.maps, userMapName);\n    return InterestPoint.getFromObjectModel(\n      usermap.pointsOfInterest,\n      interest_id\n    );\n  }\n\n  /**\n   * Insère un objet UserMap à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet UserMap que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un UserMap.\n   */\n  static insertUserMapInZoneMaps(\n    model_by_ref: { ref: CompleteModel },\n    value: UserMap,\n    key: { zone_name: string }\n  ) {\n    var zoneIndex = model_by_ref.ref.zones\n      .map(function (x) {\n        return x._id;\n      })\n      .indexOf(key.zone_name);\n    model_by_ref.ref.zones[zoneIndex].maps.push(value);\n  }\n\n  /**\n   * Insère un objet Sentier à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet Sentier que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un Sentier.\n   */\n  static insertSentierInUserMap(\n    model_by_ref: { ref: CompleteModel },\n    s: Trail,\n    key: { zone_name: string; usermap_name: string }\n  ) {\n    var zoneIndex = model_by_ref.ref.zones\n      .map(function (x) {\n        return x._id;\n      })\n      .indexOf(key.zone_name);\n    var usermapIndex = model_by_ref.ref.zones[zoneIndex].maps\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(key.usermap_name);\n    model_by_ref.ref.zones[zoneIndex].maps[usermapIndex].trails.push(s);\n  }\n\n  /**\n   * Insère un objet Coordinate à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet Coordinate que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un Coordinate.\n   */\n  static insertCoordinateInSentier(\n    model_by_ref: { ref: CompleteModel },\n    c: Coordinate,\n    key: { usermap_name: string; zone_name: string; sentier_name: string }\n  ) {\n    var zoneIndex = model_by_ref.ref.zones\n      .map(function (x) {\n        return x._id;\n      })\n      .indexOf(key.zone_name);\n    var usermapIndex = model_by_ref.ref.zones[zoneIndex].maps\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(key.usermap_name);\n    var sentierIndex = model_by_ref.ref.zones[zoneIndex].maps[\n      usermapIndex\n    ].trails\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(key.sentier_name);\n    model_by_ref.ref.zones[zoneIndex].maps[usermapIndex].trails[\n      sentierIndex\n    ].trailCoordinates.push(c);\n  }\n\n  /**\n   * Insère un objet InterestPoint à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet InterestPoint que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un InterestPoint.\n   */\n  static insertInterestPointInUserMap(\n    model_by_ref: { ref: CompleteModel },\n    ip: InterestPoint,\n    key: { usermap_name: string; zone_name: string }\n  ) {\n    var zoneIndex = model_by_ref.ref.zones\n      .map(function (x) {\n        return x._id;\n      })\n      .indexOf(key.zone_name);\n    var usermapIndex = model_by_ref.ref.zones[zoneIndex].maps\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(key.usermap_name);\n    model_by_ref.ref.zones[zoneIndex].maps[usermapIndex].pointsOfInterest.push(\n      ip\n    );\n  }\n\n  /**\n   * Insère un objet Sentier à partir d'un objet CompleteModel.\n   *\n   * @param model_by_ref Le modèle de donnée complet en objet, passé par référence.\n   * @param value L'objet InterestPointData que l'on veut insérer dans le modèle.\n   * @param key Les clés étrangères qui définissent un InterestPointData.\n   */\n  static insertInterestPointDataInInterestPoint(\n    model_by_ref: { ref: CompleteModel },\n    ipd: InterestPointData,\n    key: {\n      usermap_name: string;\n      zone_name: string;\n      interest_point_name: string;\n    }\n  ) {\n    var zoneIndex = model_by_ref.ref.zones\n      .map(function (x) {\n        return x._id;\n      })\n      .indexOf(key.zone_name);\n    var usermapIndex = model_by_ref.ref.zones[zoneIndex].maps\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(key.usermap_name);\n    var interest_pointIndex = model_by_ref.ref.zones[zoneIndex].maps[\n      usermapIndex\n    ].pointsOfInterest\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(key.interest_point_name);\n    model_by_ref.ref.zones[zoneIndex].maps[usermapIndex].pointsOfInterest[\n      interest_pointIndex\n    ].data.push(ipd);\n  }\n}\n","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/logoUniversiteSherbrooke.fd5b9722.png\";","import { DatabaseUtils } from \"../Utils/DatabaseUtils\";\n\n/**\n * @deprecated : Pour le moment, le téléchargement va se faire depuis le site des sentiers de l'Estrie.\n *\n * Méthode pour télécharger le dernier Excel utilisé pour mettre à jour l'aplication.\n */\nexport async function downloadFile() {\n  try {\n    var a = document.createElement(\"a\");\n    document.body.appendChild(a);\n    a.setAttribute(\"style\", \"display: none;\");\n    a.href = \"http://sentiersest.web810.discountasp.net/downloadFile\";\n    a.click();\n    window.URL.revokeObjectURL(\n      \"http://sentiersest.web810.discountasp.net/downloadFile\"\n    );\n    return true;\n  } catch (error) {\n    console.log(error);\n    return false;\n  }\n}\n\n/**\n * Méthode pour avoir la date du dernier update.\n */\nexport async function getLastUpdatedDate() {\n  return await DatabaseUtils.getDateFromAppStatus();\n}\n","export const colors = {\n  red: \"red\",\n  black: \"black\",\n  white: \"white\",\n  transparent: \"transparent\",\n  preview: \"#4d6d8a\",\n  previewHover: \"#375066\",\n  redBanner: \"#930000\",\n  redBannerHover: \"#800000\",\n  graySentiersEstrie: \"#cccccc\",\n  graySentiersEstrieHover: \"#9c9898\",\n  confirmationButtonColor: \"#149414\",\n  confirmationButtonHover: \"#649568\",\n  cancelButtonColor: \"#ed2939\",\n  cancelButtonHover: \"#cd5c5c\",\n  rowNotColored: \"#F1F1F1\",\n  rowColored: \"#DFDFDF\",\n  accordion: \"#375066\",\n};\n","import { useEffect, useState } from \"react\";\nimport { getLastUpdatedDate } from \"../../DesktopViews/DownloadLastFile\";\nimport { colors } from \"../../Utils/colors\";\nimport \"./Styles.css\";\n\nexport default function LastUsedExcel(): JSX.Element {\n  const [lastUpdadedDate, setLastUpdadedDate] = useState<string>(\"\");\n  /* const [errorMessage, setErrorMessage] = useState<{\n    message: ErrorMessages;\n    sendingState: SendingState;\n  }>({\n    message: ErrorMessages.none,\n    sendingState: SendingState.UNKNOWN,\n  }); */\n\n  useEffect(() => {\n    (async () => {\n      setLastUpdadedDate(await getLastUpdatedDate());\n    })();\n  }, []);\n\n  return (\n    <div\n      className=\"lastUsedExcel\"\n      style={{ backgroundColor: colors.graySentiersEstrie }}\n    >\n      <h2> Dernière mise à jour de l'application </h2>\n      <p> {lastUpdadedDate} </p>\n      <div className=\"contentSection\" style={{ borderColor: colors.redBanner }}>\n        <div className=\"getFileSection\">\n          <p style={{ marginTop: \"0px\" }}>\n            Vous pouvez recuperer la dernière version de Excel qui a mis à jour\n            l'application mobile directement sur le site des sentier de\n            l'Estrie.\n          </p>\n          {/*\n          <p style={{ marginTop: \"0px\" }}>\n            Cliquez ici pour récuperer la dernière version de Excel qui a mis à\n            jour l'application mobile\n          </p>\n          \n          <div className=\"buttonToDownloadFile\">\n            <SentiersButton\n              color={colors.redBanner}\n              hover={colors.redBannerHover}\n              textColorHover={colors.white}\n              type={MyButtonTypes.small}\n              text={\"Télécharger\"}\n              textColor={colors.white}\n              borderColor={colors.redBannerHover}\n              icon={faFileDownload}\n              onClick={async () => {\n                var isSent = await downloadFile();\n                if (!isSent) {\n                  setErrorMessage({\n                    message: ErrorMessages.failedToDownload,\n                    sendingState: SendingState.ERROR,\n                  });\n                }\n              }}\n            />\n          </div>\n          {errorMessage.sendingState !== SendingState.UNKNOWN && (\n            <div className=\"errorMessage\">\n              <Alert\n                severity={errorMessage.sendingState}\n                style={{ marginTop: \"10px\" }}\n              >\n                {errorMessage.message}\n              </Alert>\n            </div>\n          )}*/}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useEffect, useState } from \"react\";\nimport \"./Styles.css\";\n\nexport enum MyButtonTypes {\n  small = \"small\",\n  medium = \"medium\",\n  large = \"large\",\n}\n\ntype MyButtonProps = {\n  text: string;\n  type: MyButtonTypes;\n  color: string;\n  hover: string;\n  textColor: string;\n  textColorHover?: string;\n  icon?: any;\n  borderColor: string;\n  onClick: () => void;\n};\n\nexport default function SentiersButton({\n  text,\n  type,\n  color,\n  hover,\n  textColor,\n  textColorHover,\n  icon,\n  borderColor,\n  onClick,\n}: MyButtonProps): JSX.Element {\n  const [isHover, setIsHover] = useState<boolean>(false);\n  const [stateBackground, setBackgroundColor] = useState<string>(color);\n  const [stateColor, setStateColor] = useState<string>(textColor);\n\n  useEffect(() => {\n    if (isHover) {\n      setBackgroundColor(hover);\n      setStateColor(textColorHover!);\n    } else {\n      setBackgroundColor(color);\n      setStateColor(textColor);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isHover]);\n\n  return (\n    <button\n      style={{\n        backgroundColor: stateBackground,\n        color: stateColor,\n        borderColor: borderColor,\n      }}\n      onMouseOver={() => setIsHover(true)}\n      onMouseLeave={() => setIsHover(false)}\n      className={\"button \" + type}\n      onClick={onClick}\n    >\n      {icon && (\n        <FontAwesomeIcon\n          icon={icon}\n          style={{\n            marginRight: 15,\n            color: stateColor,\n          }}\n        />\n      )}\n      {text}\n    </button>\n  );\n}\n","import { makeStyles } from \"@material-ui/core/styles\";\nimport { colors } from \"../../Utils/colors\";\n\nconst useStyles = makeStyles((theme) => ({\n  normalText: {\n    fontWeight: \"bold\",\n    padding: \"2%\",\n  },\n  headings: {\n    fontWeight: \"bold\",\n    margin: 0,\n  },\n  title: {\n    display: \"block\",\n    fontSize: \"1.5em\",\n    margin: \"0.83em 0\",\n    fontWeight: \"bold\",\n  },\n  rowNotColored: {\n    backgroundColor: colors.rowNotColored,\n    padding: \"10px\",\n  },\n  rowColored: {\n    backgroundColor: colors.rowColored,\n    padding: \"10px\",\n  },\n  circularProgress: {\n    color: colors.graySentiersEstrieHover,\n    padding: \"5px\",\n  },\n  accordionElement: {\n    width: \"100%\",\n    border: \"2px solid \" + colors.accordion,\n    borderRadius: \"5px\",\n    marginBottom: \"5px\",\n  },\n  contentAligner: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    width: \"100%\",\n  },\n  preview: {\n    margin: \"0 8%\",\n  },\n  accordionDoubleElement: {\n    width: \"100%\",\n    borderRadius: \"5px\",\n  },\n  root: {\n    backgroundColor: colors.accordion,\n    color: \"white\",\n  },\n  expandIcon: {\n    color: \"white\",\n  },\n}));\n\nexport { useStyles };\n","import { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { InterestPoint } from \"../../models/interestpointsmodel\";\nimport { Queries } from \"../../models/queries\";\nimport { useStyles } from \"../Preview/Styles\";\n\ntype MyPreviewInterestPointProps = {\n  model: CompleteModel;\n  zoneId: string;\n  mapId: string;\n  interestPointName: string;\n  itemNumber: number;\n};\n\nexport default function PreviewInterestPoint({\n  model,\n  zoneId,\n  mapId,\n  interestPointName,\n  itemNumber,\n}: MyPreviewInterestPointProps): JSX.Element {\n  const [premiseInterestPoint, setInterestPoint] = useState<InterestPoint>();\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    var poi = Queries.getInterestPointsFromObjectModel(\n      model,\n      zoneId,\n      mapId,\n      interestPointName\n    );\n    setInterestPoint(poi);\n  });\n\n  return (\n    <div\n      className={\n        itemNumber % 2 !== 0 ? classes.rowColored : classes.rowNotColored\n      }\n    >\n      <div className=\"poiName\">\n        <b>{premiseInterestPoint?.name} </b>\n      </div>\n      <div className=\"santierDifficulte\">\n        Coordonnée : {premiseInterestPoint?.coordinate.longitude},\n        {premiseInterestPoint?.coordinate.latitude}\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { Queries } from \"../../models/queries\";\nimport { Trail } from \"../../models/trailmodel\";\nimport { useStyles } from \"../Preview/Styles\";\n\ntype MyPreviewTrailProps = {\n  model: CompleteModel;\n  zoneId: string;\n  mapId: string;\n  trailName: string;\n  itemNumber: number;\n};\n\nexport default function PreviewTrail({\n  model,\n  zoneId,\n  mapId,\n  trailName,\n  itemNumber,\n}: MyPreviewTrailProps): JSX.Element {\n  const [premiseTrail, setTrail] = useState<Trail>();\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    var t = Queries.getSentierFromObjectModel(model, zoneId, mapId, trailName);\n    setTrail(t);\n  });\n\n  return (\n    <div\n      className={\n        itemNumber % 2 !== 0 ? classes.rowColored : classes.rowNotColored\n      }\n    >\n      <div className=\"trailName\">\n        <b> {premiseTrail?.name} </b>\n      </div>\n      <div className=\"trailDifficulty\">\n        Difficulté : {premiseTrail?.difficulty}\n      </div>\n    </div>\n  );\n}\n","import Accordion from \"@material-ui/core/Accordion\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport React, { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { InterestPoint } from \"../../models/interestpointsmodel\";\nimport { Queries } from \"../../models/queries\";\nimport { Trail } from \"../../models/trailmodel\";\nimport { useStyles } from \"../Preview/Styles\";\nimport PreviewInterestPoint from \"../PreviewInterestPoint/PreviewInterestPoint\";\nimport PreviewTrail from \"../PreviewTrail/PreviewTrail\";\n\ntype MyPreviewMapProps = {\n  model: CompleteModel;\n  zoneId: string;\n  mapId: string;\n};\n\nexport default function PreviewMap({\n  model,\n  zoneId,\n  mapId,\n}: MyPreviewMapProps): JSX.Element {\n  const [premiseMapId, setMapId] = useState<string>(\"\");\n  const [trails, setTrails] = useState<Trail[]>([]);\n  const [interestPoints, setIterestPoints] = useState<InterestPoint[]>([]);\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    var m = Queries.getUserMapFromObjectModel(model, zoneId, mapId);\n    setMapId(m.name);\n    setTrails(m.trails);\n    setIterestPoints(m.pointsOfInterest);\n  });\n\n  return (\n    <div className={classes.accordionElement}>\n      <Accordion>\n        <AccordionSummary\n          expandIcon={<ExpandMoreIcon className={classes.expandIcon} />}\n          aria-controls=\"panel1a-content\"\n          id={premiseMapId}\n          className={classes.root}\n        >\n          <p className={classes.headings}> Carte : {premiseMapId} </p>\n        </AccordionSummary>\n        <AccordionDetails>\n          <div className={classes.accordionDoubleElement}>\n            <div className={classes.accordionElement}>\n              <div>\n                <Accordion>\n                  <AccordionSummary\n                    expandIcon={\n                      <ExpandMoreIcon className={classes.expandIcon} />\n                    }\n                    aria-controls=\"panel1a-content\"\n                    className={classes.root}\n                  >\n                    <p className={classes.headings}> Sentiers </p>\n                  </AccordionSummary>\n                  {trails.length === 0 ? (\n                    <p className={classes.normalText}>\n                      Vous avez créé une carte sans lui associer de sentier(s)\n                    </p>\n                  ) : (\n                    <AccordionDetails>\n                      <div className={classes.contentAligner}>\n                        {trails.map((trail: Trail, index) => (\n                          <PreviewTrail\n                            key={trail.name}\n                            model={model}\n                            zoneId={zoneId}\n                            mapId={premiseMapId}\n                            trailName={trail.name}\n                            itemNumber={index}\n                          />\n                        ))}\n                      </div>\n                    </AccordionDetails>\n                  )}\n                </Accordion>\n              </div>\n            </div>\n            <div className={classes.accordionElement}>\n              <div>\n                <Accordion>\n                  <AccordionSummary\n                    expandIcon={\n                      <ExpandMoreIcon className={classes.expandIcon} />\n                    }\n                    aria-controls=\"panel1a-content\"\n                    className={classes.root}\n                  >\n                    <p className={classes.headings}> Points d'intérêt </p>\n                  </AccordionSummary>\n                  {interestPoints.length === 0 ? (\n                    <p className={classes.normalText}>\n                      Vous avez créé une carte sans lui associer de point(s)\n                      d'intérêt\n                    </p>\n                  ) : (\n                    <AccordionDetails>\n                      <div className={classes.contentAligner}>\n                        {interestPoints.map(\n                          (interestPoint: InterestPoint, index) => (\n                            <PreviewInterestPoint\n                              key={interestPoint.name}\n                              model={model}\n                              zoneId={zoneId}\n                              mapId={premiseMapId}\n                              interestPointName={interestPoint.name}\n                              itemNumber={index}\n                            />\n                          )\n                        )}\n                      </div>\n                    </AccordionDetails>\n                  )}\n                </Accordion>\n              </div>\n            </div>\n          </div>\n        </AccordionDetails>\n      </Accordion>\n    </div>\n  );\n}\n","import Accordion from \"@material-ui/core/Accordion\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport React, { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport { Queries } from \"../../models/queries\";\nimport { UserMap } from \"../../models/usermapmodel\";\nimport { useStyles } from \"../Preview/Styles\";\nimport PreviewMap from \"../PreviewMap/PreviewMap\";\n\ntype MyPreviewZoneProps = {\n  model: CompleteModel;\n  zoneId: string;\n};\n\nexport default function PreviewZone({\n  model,\n  zoneId,\n}: MyPreviewZoneProps): JSX.Element {\n  const [premiseZoneId, setZoneId] = useState<string>(\"\");\n  const [maps, setMaps] = useState<UserMap[]>([]);\n  const classes = useStyles();\n\n  // eslint-disable-next-line\n  useEffect(() => {\n    var z = Queries.getZoneFromObjectModel(model, zoneId);\n    setZoneId(z._id);\n    setMaps(z.maps);\n  });\n\n  return (\n    <div className={classes.accordionElement}>\n      <Accordion>\n        <AccordionSummary\n          expandIcon={<ExpandMoreIcon className={classes.expandIcon} />}\n          aria-controls=\"panel1a-content\"\n          id={premiseZoneId}\n          className={classes.root}\n        >\n          <p className={classes.headings}> Zone : {premiseZoneId} </p>\n        </AccordionSummary>\n        {maps.length === 0 ? (\n          <p className={classes.normalText}>\n            Vous avez créé une zone sans lui associer de carte(s)\n          </p>\n        ) : (\n          <AccordionDetails>\n            <div className={classes.contentAligner}>\n              {\n                /*maps &&*/\n                maps.map((map: UserMap) => (\n                  <PreviewMap\n                    key={map.name}\n                    model={model}\n                    zoneId={premiseZoneId}\n                    mapId={map.name}\n                  />\n                ))\n              }\n            </div>\n          </AccordionDetails>\n        )}\n      </Accordion>\n    </div>\n  );\n}\n","import Accordion from \"@material-ui/core/Accordion\";\nimport AccordionDetails from \"@material-ui/core/AccordionDetails\";\nimport AccordionSummary from \"@material-ui/core/AccordionSummary\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport React, { useEffect, useState } from \"react\";\nimport { CompleteModel } from \"../../models/completemodel\";\nimport PreviewZone from \"../PreviewZone/PreviewZone\";\nimport { Zone } from \"./../../models/zonemodel\";\nimport { useStyles } from \"./Styles\";\n\ntype MyProps = {\n  m: CompleteModel;\n};\nexport default function Preview({ m }: MyProps): JSX.Element {\n  const [model, setModel] = useState<CompleteModel>(new CompleteModel());\n  const [zones, setZones] = useState<Zone[]>([]);\n  const classes = useStyles();\n\n  useEffect(() => {\n    setModel(m);\n    setZones(m.zones);\n    // eslint-disable-next-line\n  }, []);\n\n  return (\n    <div className={classes.preview}>\n      <p className={classes.title}> Aperçu des données </p>\n      <div className={classes.accordionElement}>\n        <Accordion>\n          <AccordionSummary\n            expandIcon={<ExpandMoreIcon className={classes.expandIcon} />}\n            aria-controls=\"panel1a-content\"\n            id=\"accordionSummary\"\n            className={classes.root}\n          >\n            <p className={classes.headings}> Zones </p>\n          </AccordionSummary>\n          {zones.length === 0 ? (\n            <CircularProgress className={classes.circularProgress} />\n          ) : (\n            <AccordionDetails>\n              <div className={classes.contentAligner}>\n                {\n                  // boucle for each sur les zones dans l'objet\n                  zones.map((zone: Zone) => (\n                    <PreviewZone\n                      key={zone._id}\n                      model={model}\n                      zoneId={zone._id}\n                    />\n                  ))\n                }\n              </div>\n            </AccordionDetails>\n          )}\n        </Accordion>\n      </div>\n    </div>\n  );\n}\n","import { CompleteModel } from \"../models/completemodel\";\nimport { DatabaseUtils } from \"../Utils/DatabaseUtils\";\nimport { ImportExcelFile } from \"../Utils/ImportExcelFile\";\n\n// Fonction pour avoir un preview du contenu que l'utilisateur veut ajuster sur l'application\n/**\n * Méthode pour exporter le dernier Excel utilisé pour mettre à jour l'aplication.\n *\n * @param excel Le fichier excel à parser.\n * @returns {boolean, CompleteModel} vrai si les informations ont reussi à être parsées ainsi que le model resultant.\n */\nexport default async function sendForPreview(excel: File) {\n  var err = await DatabaseUtils.destroy();\n  var defaultModel = new CompleteModel();\n  if (err === null) {\n    if (excel.name === \"\") {\n      return {\n        isSent: Promise.resolve(false),\n        model: Promise.resolve(defaultModel),\n      };\n    }\n    var doneModel = await ImportExcelFile.fetchDataFromExcel(excel);\n    if (doneModel === undefined || doneModel.zones.length === 0) {\n      return {\n        isSent: Promise.resolve(false),\n        model: Promise.resolve(defaultModel),\n      };\n    }\n    return { isSent: Promise.resolve(true), model: Promise.resolve(doneModel) };\n  }\n  return {\n    isSent: Promise.resolve(false),\n    model: Promise.resolve(defaultModel),\n  };\n}\n","import { CompleteModel } from \"../models/completemodel\";\nimport { DatabaseUtils } from \"../Utils/DatabaseUtils\";\n\n/**\n * Méthode pour confirmer la mise à jour de l'application selon le preview.\n *\n * @param excel Le fichier excel à envoyer sur le serveur..\n * @param model Le model à envoyer sur le serveur.\n * @returns vrai si les informations ont été envoyées au serveur.\n */\nexport async function sendForUpdate(\n  excel: File,\n  model: CompleteModel\n): Promise<boolean> {\n  var error = await DatabaseUtils.sendModelToServer(excel, model);\n  if (error === null) {\n    return Promise.resolve(true);\n  } else {\n    console.log(\"Erreur lors de l'envoi sur le serveur. \" + error);\n    return Promise.resolve(false);\n  }\n}\n\n/**\n * Méthode pour pour detruire la bd, annuler.\n *\n * @returns vrai si les informations ont été supprimées.\n */\nexport async function deleteLocalDB(): Promise<boolean> {\n  var error = await DatabaseUtils.destroy();\n  if (error === null) {\n    return Promise.resolve(true);\n  }\n  console.warn(\" Erreur lors de la destruction de la BD: \" + error);\n  return Promise.resolve(false);\n}\n","import { faFileImport } from \"@fortawesome/free-solid-svg-icons\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport React, { useState } from \"react\";\nimport SentiersButton, {\n  MyButtonTypes,\n} from \"../DesktopComponents/Button/SentiersButton\";\nimport Preview from \"../DesktopComponents/Preview/Preview\";\nimport sendForPreview from \"../DesktopViews/PreviewView\";\nimport { deleteLocalDB, sendForUpdate } from \"../DesktopViews/UpdateView\";\nimport { CompleteModel } from \"../models/completemodel\";\nimport { colors } from \"../Utils/colors\";\nimport \"./Styles.css\";\n\nexport enum SendingState {\n  ERROR = \"error\",\n  SUCCESS = \"success\",\n  UNKNOWN = \"unsend\",\n  WARNING = \"warning\",\n}\n\nexport enum ErrorMessages {\n  failedToSend = \" Une erreur est survenue lors de la mise à jour du contenu de l'application. \",\n  none = \"\",\n  succeedToSend = \" L'application a été mise à jour! \",\n  notAnExcel = \" Vous n'avez pas selectionné un fichier .xlsx! \",\n  failedToParse = \" Veuillez entrer un excel adapté à l'application. \",\n  failedToDeleteDB = \" Une erreur est survenue lors de la cancelation. \",\n  missingFile = \"Veuillez sélectionner un fichier. \",\n  failedToDownload = \" Une erreur est survenue lors du téléchargement du fichier. \",\n  succeedToDownload = \" Le fichier a été téléchargé! \",\n}\n\ntype Props = {\n  visibilityToggle: (isVisible: boolean) => void;\n};\n\n// Fonction principale\nexport default function UpdateAppMap({ visibilityToggle }: Props): JSX.Element {\n  const [receivedFile, setFile] = useState<File>();\n  const [displayPreview, setDisplayPreview] = useState<boolean>(false);\n  const [fileName, setFileName] = useState<string>(\"\");\n  const [aFileWasAdded, setAFileWasAdded] = useState<boolean>(false);\n  const [modelRecieved, setModel] = useState<CompleteModel>(\n    new CompleteModel()\n  );\n\n  const [errorMessage, setErrorMessage] = useState<{\n    message: ErrorMessages;\n    sendingState: SendingState;\n  }>({\n    message: ErrorMessages.none,\n    sendingState: SendingState.UNKNOWN,\n  });\n\n  function resetInput(event: any) {\n    event.target.value = \"\";\n  }\n\n  // vérifier que l'utilisateur a bien selectioné un fichier excel\n  function HandleFileInput(event: React.ChangeEvent<HTMLInputElement>): void {\n    const file = event.target.files?.item(0);\n    setDisplayPreview(false);\n    visibilityToggle(true);\n    setErrorMessage({\n      message: ErrorMessages.none,\n      sendingState: SendingState.UNKNOWN,\n    });\n    if (file !== undefined) {\n      if (file!.name.split(\".\").pop() === \"xlsx\") {\n        setAFileWasAdded(true);\n        setFile(file!);\n        setFileName(file!.name);\n      } else {\n        // Erreur de fichier, ce n'est pas un Excel\n        setErrorMessage({\n          message: ErrorMessages.notAnExcel,\n          sendingState: SendingState.ERROR,\n        });\n      }\n    } else {\n      // Erreur de fichier, ce n'est pas un Excel\n      setErrorMessage({\n        message: ErrorMessages.missingFile,\n        sendingState: SendingState.ERROR,\n      });\n    }\n  }\n\n  async function sendForPreviewOnClick(file: File) {\n    var response = await sendForPreview(file!);\n    var isSent = await response.isSent;\n    setModel(await response.model);\n    setDisplayPreview(isSent);\n    visibilityToggle(!isSent);\n    if (!isSent) {\n      setErrorMessage({\n        message: ErrorMessages.failedToParse,\n        sendingState: SendingState.ERROR,\n      });\n    }\n  }\n\n  async function cancelUpdateOnClick() {\n    setErrorMessage({\n      message: ErrorMessages.none,\n      sendingState: SendingState.UNKNOWN,\n    });\n    setDisplayPreview(false);\n    visibilityToggle(true);\n    setFileName(\"\");\n    setFile(undefined);\n    setAFileWasAdded(false);\n    const statusDelete: boolean = await deleteLocalDB();\n    if (!statusDelete) {\n      setErrorMessage({\n        message: ErrorMessages.failedToDeleteDB,\n        sendingState: SendingState.WARNING,\n      });\n    }\n  }\n\n  async function sendForUpdateOnClick(file: File, model: CompleteModel) {\n    const statusSend: boolean = await sendForUpdate(file!, model);\n    if (statusSend) {\n      setErrorMessage({\n        message: ErrorMessages.succeedToSend,\n        sendingState: SendingState.SUCCESS,\n      });\n      setFileName(\"\");\n      setFile(undefined);\n      setDisplayPreview(false);\n      visibilityToggle(true);\n      setAFileWasAdded(false);\n    } else {\n      setErrorMessage({\n        message: ErrorMessages.failedToSend,\n        sendingState: SendingState.ERROR,\n      });\n    }\n  }\n\n  return (\n    <div className=\"updateAppMap\">\n      <h2>Mettre à jour l'application mobile</h2>\n      <div className=\"form\">\n        <div className=\"infoForPreview\">\n          <div className=\"fileInputSection\">\n            <p style={{ marginTop: \"0px\" }}>\n              Veuillez sélectionner un fichier Excel\n            </p>\n            <div style={{ display: \"flex\", alignItems: \"center\" }}>\n              <div className=\"importFileButton\">\n                <input\n                  type=\"file\"\n                  id=\"selectedFile\"\n                  style={{ display: \"none\" }}\n                  accept=\".xlsx\"\n                  required\n                  onClick={resetInput}\n                  onChange={HandleFileInput}\n                />\n                <SentiersButton\n                  type={MyButtonTypes.small}\n                  color={colors.graySentiersEstrie}\n                  hover={colors.graySentiersEstrieHover}\n                  text={\"Importer un fichier\"}\n                  textColor={colors.black}\n                  textColorHover={colors.white}\n                  borderColor={colors.graySentiersEstrie}\n                  icon={faFileImport}\n                  onClick={() => {\n                    var doc = document.getElementById(\"selectedFile\");\n                    if (doc) {\n                      doc.click();\n                    }\n                  }}\n                />\n                {receivedFile?.name && (\n                  <p\n                    style={{\n                      fontSize: 11,\n                      fontStyle: \"italic\",\n                      marginLeft: \"1em\",\n                    }}\n                  >\n                    {fileName}\n                  </p>\n                )}\n              </div>\n            </div>\n            {errorMessage.sendingState !== SendingState.UNKNOWN && (\n              <div>\n                <Alert\n                  severity={errorMessage.sendingState}\n                  style={{ marginTop: \"10px\" }}\n                >\n                  {errorMessage.message}\n                </Alert>\n              </div>\n            )}\n          </div>\n          {/*afficher le bouton de previsualistion si un nouveau fichier de type excel est entré */}\n          {aFileWasAdded && !displayPreview && (\n            <div className=\"previewSection\">\n              <p>\n                Afin de mettre à jour l’application, assurez-vous de\n                prévisualiser le contenu et le confirmer\n              </p>\n              <div className=\"previewButton\">\n                <SentiersButton\n                  color={colors.redBanner}\n                  hover={colors.redBannerHover}\n                  textColorHover={colors.white}\n                  type={MyButtonTypes.large}\n                  text={\"Prévisualiser\"}\n                  textColor={colors.white}\n                  borderColor={colors.redBannerHover}\n                  onClick={async () => {\n                    await sendForPreviewOnClick(receivedFile!);\n                  }}\n                />\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      {displayPreview && (\n        <div className=\"infoForUpdate\">\n          <div className=\"UpdateButtons\">\n            <div className=\"cancelButton\">\n              <SentiersButton\n                color={colors.transparent}\n                hover={colors.red}\n                type={MyButtonTypes.medium}\n                text={\"Annuler\"}\n                textColor={colors.red}\n                textColorHover={colors.white}\n                borderColor={colors.red}\n                onClick={async () => {\n                  await cancelUpdateOnClick();\n                }}\n              />\n            </div>\n            <div className=\"confirmButton\">\n              <SentiersButton\n                color={colors.confirmationButtonColor}\n                hover={colors.confirmationButtonHover}\n                type={MyButtonTypes.medium}\n                text={\"Confirmer\"}\n                textColor={colors.white}\n                textColorHover={colors.white}\n                borderColor={colors.confirmationButtonColor}\n                onClick={async () => {\n                  await sendForUpdateOnClick(receivedFile!, modelRecieved);\n                }}\n              />\n            </div>\n          </div>\n          <Preview key=\"preview\" m={modelRecieved} />\n        </div>\n      )}\n    </div>\n  );\n}\n","export const images = {\n  logoSentiersEstrie: require(\"./logoSentiersEstrie.png\"),\n  logoUniversiteSherbrooke: require(\"./logoUniversiteSherbrooke.png\"),\n};\n","import { images } from \"../Assets/sentiersImages\";\nimport { colors } from \"./colors\";\nimport \"./Styles.css\";\n\nexport default function Header(): JSX.Element {\n  return (\n    <div className=\"topBanner\" style={{ backgroundColor: colors.redBanner }}>\n      <div className=\"column\">\n        <img src={images.logoSentiersEstrie.default} alt=\"logoSentiersEstrie\" />\n      </div>\n    </div>\n  );\n}\n","import {\n  ThemeProvider,\n  unstable_createMuiStrictModeTheme,\n} from \"@material-ui/core/styles\";\nimport React, { useState } from \"react\";\nimport \"./App.css\";\nimport LastUsedExcel from \"./DesktopComponents/LastUsedExcel/LastUsedExcel\";\nimport UpdateAppMap from \"./DesktopControllers/UpdateAppMap\";\nimport Header from \"./Utils/HeaderSentier\";\nconst theme = unstable_createMuiStrictModeTheme();\n\nfunction App(): JSX.Element {\n  const [isVisible, setIsVisibile] = useState<boolean>(true);\n\n  return (\n    <div className=\"App\">\n      <ThemeProvider theme={theme}>\n        <Header />\n        <UpdateAppMap visibilityToggle={setIsVisibile} />\n        {isVisible && <LastUsedExcel />}\n      </ThemeProvider>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  isAuthorized(),\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n\n\nfunction isAuthorized() {\n  // url du serveur\n  var urlRefOK = \"http://sentiersest.web810.discountasp.net/interfaceAdmin\";\n  var urlRefOK2 = \"http://sentiersest.web810.discountasp.net/interfaceAdminTest\";\n\n  // si la personne n'a pas passé par le server et accede à la page directement on la redirige vers le serveur pour verifier les credentials\n  if (\n    // si il ne vient pas directement du serveur\n    !document.referrer.match(urlRefOK) ||\n    // si il ne vient pas directement du serveur\n    !document.referrer.match(urlRefOK2)\n  ) {\n    window.location.replace(\"https://www.lessentiersdelestrie.qc.ca/\");\n  }\n}","import PouchDB from \"pouchdb\";\nimport { CompleteModel } from \"../models/completemodel\";\n\nexport class DatabaseUtils {\n  /**\n   * Retourne le nom à utiliser pour instancier une base de données. Doit être un nom sans slash '/': sur Windows\n   * PouchDB peut-être instancié à n'importe quel endroit dans le projet mais le constructeur utilisant un \"path\"\n   * échoue sur Linux. Par soucis d'uniformité nous n'utiliserons pas de \"path\" dans le constructeur de la DB.\n   */\n  public static getProdDB() {\n    return \"db_prod\";\n  }\n  public static getIntegrationTestDB() {\n    return \"db_integrationtest\";\n  }\n\n  /** @deprecated Instancie une base de données dans un dossier à la racine du projet. */\n  /* static async makeDB(name: string) {\n    var db = new PouchDB(name);\n\n    var doc = null;\n    try {\n      doc = await db.info();\n    } catch (err) {\n      console.log(err);\n    } finally {\n      await db.close();\n    }\n\n    return doc;\n  } */\n\n  /** Va chercher tous les json ainsi que toutes les classes imbriquées du fichier NoSQL et l'affiche à l'écran */\n  static async getAllDocuments() {\n    var db = new PouchDB(DatabaseUtils.getProdDB());\n\n    var options = {\n      include_docs: true,\n      attachments: true,\n    };\n\n    var doc;\n    try {\n      doc = await db.allDocs(options);\n    } catch (err) {\n      console.log(err);\n    } finally {\n      await db.close();\n    }\n\n    return doc;\n  }\n\n  /** Détruit la BD prod */\n  static async destroy() {\n    var db = new PouchDB(DatabaseUtils.getProdDB());\n\n    var e = null;\n    try {\n      await db.destroy();\n    } catch (err) {\n      e = err;\n    }\n\n    return e;\n  }\n\n  /** Envoie le model et le excel servant à mettre à jour sur le serveur */\n  static async sendModelToServer(excel: File, model: CompleteModel) {\n    var e = null;\n    try {\n      // envoyer le json\n      var response = await DatabaseUtils.postRequestToServer(\n        JSON.stringify(model),\n        false\n      );\n      if (response === 200) {\n        // envoyer le excel\n        response = await DatabaseUtils.postRequestToServer(excel, true);\n        if (response === 200) {\n          return e;\n        }\n      }\n      return \" Le statut de la réponse HTTP éronée est : \" + response;\n    } catch (err) {\n      e = err;\n      console.log(e);\n    }\n\n    return e;\n  }\n\n  /** Requete POST pour envoyer les informations au serveur */\n  static async postRequestToServer(toSend: any, isExcel: boolean) {\n    var formdata = toSend;\n    var requestHeaders;\n\n    var destinationUri =\n      \"http://sentiersest.web810.discountasp.net/updateAppContent\";\n\n    if (isExcel) {\n      formdata = new FormData();\n      formdata.append(\"spreadsheet\", toSend);\n      destinationUri = \"http://sentiersest.web810.discountasp.net/uploadFile\";\n      requestHeaders = {\n        Accept: \"*/*\",\n      };\n    } else {\n      requestHeaders = {\n        \"Content-Type\": \"application/json\",\n      };\n    }\n\n    var requestOptions: RequestInit = {\n      method: \"POST\",\n      headers: requestHeaders,\n      body: formdata,\n    };\n    try {\n      var response = await fetch(destinationUri, requestOptions);\n      return response.status;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  static async getDateFromAppStatus() {\n    try {\n      var requestOptions = {\n        method: \"GET\",\n      };\n      var response = await fetch(\n        \"http://sentiersest.web810.discountasp.net/getStatus\",\n        requestOptions\n      );\n      return response.text();\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n","import { Zone } from \"./zonemodel\";\n\n/**\n * Contient l'ensemble du modèle de données dans un objet typescript\n */\nexport class CompleteModel {\n  zones: Zone[];\n\n  constructor() {\n    this.zones = Array<Zone>();\n  }\n}\n","/**\n * Structure de donnée pour une coordonnée\n */\nexport class Coordinate {\n    longitude: number | undefined;\n    latitude: number | undefined;\n    altitude: number | undefined;\n\n    constructor(longitude: number | undefined, latitude:number | undefined, altitude:number | undefined = undefined) {\n      this.longitude = longitude;\n      this.latitude = latitude;\n      this.altitude = altitude;\n    }\n}","import PouchDB from \"pouchdb\";\nimport { DatabaseUtils } from \"../Utils/DatabaseUtils\";\nimport { UserMap } from \"./usermapmodel\";\n\n/**\n * Modèle de donnée pour une zone.\n *\n * Relations:\n *   Zone -|---N- UserMap\n */\nexport class Zone {\n  // Attributes\n  _id: string; // nom de la zone\n\n  // Relations\n  maps: Array<UserMap>;\n\n  constructor(name: string, maps: Array<UserMap>) {\n    this._id = name;\n    this.maps = maps;\n  }\n\n  /**\n   * Retourne un objet Zone provenant du modèle objet complet\n   *\n   * params:\n   *   zones: L'attribut 'zones' de la classe 'CompleteModel'\n   *   zoneName: L'ID de la zone que l'on veut obtenir\n   */\n  static getFromObjectModel(zones: Array<Zone>, zoneName: string) {\n    var zoneIndex = zones\n      .map(function (x) {\n        return x._id;\n      })\n      .indexOf(zoneName);\n    return zones[zoneIndex];\n  }\n\n  /** Sauvegarde un objet Zone dans un document NoSQL */\n  async save() {\n    var db = new PouchDB(DatabaseUtils.getProdDB());\n    var doc = null;\n    try {\n      doc = await db.post({\n        _id: this._id,\n        maps: this.maps,\n      });\n    } catch (err) {\n      console.log(err);\n    } finally {\n      await db.close();\n    }\n\n    return doc;\n  }\n\n  /** Va chercher un objet Zone ainsi que toutes les classes imbriquées dans un document NoSQL */\n  static async get(id: string) {\n    var db = new PouchDB(DatabaseUtils.getProdDB());\n\n    var doc: Zone;\n    try {\n      doc = await db.get<Zone>(id);\n    } catch (err) {\n      return err;\n    } finally {\n      await db.close();\n    }\n\n    return new Zone(doc![\"_id\"], doc!.maps);\n  }\n}\n","import { Coordinate } from \"./coordinatemodel\";\nimport { InterestPointData } from \"./interestpointdatamodel\";\n\n/**\n * Les types de points qui sont possible d'utiliser. Nous pourrons appliquer des comportements à l'application en\n * fonction du type de point.\n */\nexport enum InterestType {\n  service = \"service\",\n  summit = \"summit\",\n  view = \"view\",\n  nature = \"nature\",\n  parking = \"parking\",\n  restroom = \"restroom\",\n  camping = \"camping\",\n  telephone = \"telephone\",\n  picnic = \"picnic\",\n  refuge = \"refuge\",\n  hosting = \"hosting\",\n  unknown = \"unknown\",\n}\n\nexport function getInterestType(x: string): InterestType {\n  return (InterestType as any)[x];\n}\n\n/**\n * Modèle de donnée pour un point d'intérêt\n *\n * Relations:\n *   InterestPoint -N---|- UserMap\n *\n *   InterestPoint -|---|- Coordinate\n */\nexport class InterestPoint {\n  // Attributes\n  name: string;\n  description: string;\n  type: InterestType;\n  uri?: string[];\n  activeWindow?: Date[];\n  code: string;\n\n  // Relations\n  coordinate: Coordinate;\n  data: InterestPointData[];\n\n  constructor(\n    name: string,\n    description: string,\n    type: InterestType,\n    coordinate: Coordinate,\n    code: string,\n    dateDebut: Date | undefined,\n    dateFin: Date | undefined\n  ) {\n    this.name = name;\n    this.description = description;\n    this.type = type;\n    this.coordinate = coordinate;\n    this.data = new Array<InterestPointData>();\n    this.code = code;\n\n    if (dateDebut !== undefined && dateFin !== undefined) {\n      this.activeWindow = Array<Date>();\n      this.activeWindow.push(dateDebut);\n      this.activeWindow.push(dateFin);\n    }\n  }\n\n  /**\n   * Retourne un objet InterestPoint à partir d'un objet UserMap\n   *\n   * params:\n   *   interestPoints: L'attribut 'interestPoint' de la classe 'UserMap'\n   *   sentierName: L'ID du sentier que l'on veut obtenir\n   */\n  static getFromObjectModel(\n    interestPoints: Array<InterestPoint>,\n    interest_id: string\n  ) {\n    var index = interestPoints\n      .map(function (x) {\n        return x.name;\n      })\n      .indexOf(interest_id);\n    var sentier = interestPoints[index];\n\n    return sentier;\n  }\n\n  static getTypeFromString(type: string) {\n    switch (type) {\n      case \"Parking\":\n        return InterestType.parking;\n      case \"Point de vue\":\n        return InterestType.view;\n      case \"TÃ©lÃ©phone\":\n        return InterestType.telephone;\n      case \"Piquenique\":\n        return InterestType.picnic;\n      case \"Camping rustique\" || \"Camping\":\n        return InterestType.camping;\n      case \"Refuge\":\n        return InterestType.refuge;\n      case \"HÃ©bergement\":\n        return InterestType.hosting;\n      case \"Toilettes\":\n        return InterestType.restroom;\n      default:\n        return InterestType.unknown;\n    }\n  }\n}\n","import { InterestPoint } from './interestpointsmodel';\nimport { Trail } from './trailmodel';\nimport {Coordinate} from \"./coordinatemodel\";\n\n/**\n * Modèle de donnée pour une carte\n *\n * Relations:\n *   UserMap -N---|- Zone\n *\n *   UserMap -|---N- Trail\n *   UserMap -|---N- InterestPoint\n */\nexport class UserMap {\n\n  // Attributes\n  name: string;\n  map_file: string;\n  topLeftCoordinate: Coordinate;\n  topRightCoordinate: Coordinate;\n  bottomLeftCoordinate: Coordinate;\n  bottomRightCoordinate: Coordinate;\n\n  // Relations\n  trails: Trail[];\n  pointsOfInterest: InterestPoint[];\n  \n  constructor(name:string, map_file:string, sentiers:Trail[], pointsOfInterest:InterestPoint[],\n              topLeftCoordinate:Coordinate, topRightCoordinate: Coordinate, bottomLeftCoordinate: Coordinate,\n              bottomRightCoordinate: Coordinate) {\n    this.name = name;\n    this.map_file = map_file;\n    this.trails = sentiers;\n    this.pointsOfInterest = pointsOfInterest;\n    this.topLeftCoordinate = topLeftCoordinate;\n    this.topRightCoordinate = topRightCoordinate;\n    this.bottomLeftCoordinate = bottomLeftCoordinate;\n    this.bottomRightCoordinate = bottomRightCoordinate;\n  }\n\n  /**\n   * Retourne un objet UserMap à partir d'un objet Zone\n   *\n   * params:\n   *   userMaps: L'attribut 'maps' de la classe 'Zone'\n   *   userMapName: L'ID de la carte que l'on veut obtenir\n   */\n  static getFromObjectModel(usermaps: Array<UserMap>, userMapName: string){\n    var index = usermaps.map(function(x) {return x.name; }).indexOf(userMapName);\n    var usermap = usermaps[index];\n\n    return usermap;\n  }\n}","import { Coordinate } from './coordinatemodel'\n\n/**\n * Modèle de donnée pour un Sentier\n *\n * Relations:\n *   Sentier -N---|- UserMap\n *\n *   Sentier -|---N- Coordinate\n */\nexport class Trail {\n\n  // Attributes\n  name: string;\n  description: string | undefined;\n  difficulty: number;\n  uri?: string[];\n  activeWindow?: Date[];\n  color?: string;\n\n  // Relations\n  trailCoordinates: Coordinate[];\n\n  constructor(name: string, description: string | undefined, difficulty: number, dateDebut: Date | undefined, dateFin: Date | undefined, color = \"black\") {\n    this.name = name;\n    this.description = description;\n    this.difficulty = difficulty;\n    this.color = color;\n    this.trailCoordinates = Array<Coordinate>();\n\n    if(dateDebut !== undefined && dateFin !== undefined){\n      this.activeWindow = Array<Date>();\n      this.activeWindow.push(dateDebut);\n      this.activeWindow.push(dateFin);\n    }\n  }\n\n  /** Ajoute un point au sentier */\n  addPoint(point:Coordinate){\n    this.trailCoordinates.push(point);\n  }\n\n  /**\n   * Retourne un objet Sentier à partir d'un objet UserMap\n   *\n   * params:\n   *   sentiers: L'attribut 'sentiers' de la classe 'UserMap'\n   *   sentierName: L'ID du sentier que l'on veut obtenir\n   */\n  static getFromObjectModel(sentiers: Array<Trail>, sentierName:string){\n    var index = sentiers.map(function(x) {return x.name; }).indexOf(sentierName);\n    var sentier = sentiers[index];\n\n    return sentier;\n  }\n}","/**\n * Les types de données qui sont possible d'utiliser.\n */\nexport enum DataType {\n  video = \"video\",\n  image = \"image\",\n  texte = \"texte\",\n}\n\nexport function getDataType(x: string): DataType {\n  return (DataType as any)[x];\n}\n\n/**\n * Modèle de donnée pour les fichiers et le texte associé à un point d'intérêt.\n *\n * Relations:\n *   InterestPointData -N---|-InterestPoint\n */\nexport class InterestPointData {\n  // Attributes\n  type: DataType;\n  data: string;\n\n  constructor(type: DataType, data: string) {\n    this.type = type;\n    this.data = data;\n  }\n}\n","import { Workbook, Worksheet } from \"exceljs\";\nimport { CompleteModel } from \"../models/completemodel\";\nimport { Coordinate } from \"../models/coordinatemodel\";\nimport {\n  getDataType,\n  InterestPointData,\n} from \"../models/interestpointdatamodel\";\nimport { getInterestType, InterestPoint } from \"../models/interestpointsmodel\";\nimport { Queries } from \"../models/queries\";\nimport { Trail } from \"../models/trailmodel\";\nimport { UserMap } from \"../models/usermapmodel\";\nimport { Zone } from \"../models/zonemodel\";\n\n/** Classe d'intégration avec Excel */\nexport class ImportExcelFile {\n  /**\n   * Méthode pour migrer les données du client vers le fichier Excel d'entrée de données. Le fichier d'entrée doit\n   * etre en CSV.\n   *\n   * @param csv Le nom du fichier duquel on veut extraire les données, en csv.\n   * @param xlsx Le nom du fichier qu'on veut générer avec les données, en xlsx.\n   * @returns write_succesful Un string qui indique si l'écriture du fichier Excel résultant est un succès.\n   */\n  static async MigrateDataFromCSVToXLSX(csv: string, xlsx: string) {\n    let wb: Workbook = new Workbook();\n    let model = new CompleteModel();\n    let defaultMap = \"default\";\n\n    await wb.csv.readFile(csv);\n\n    const ws = wb.worksheets[0];\n    ws.eachRow((row, rowNumber) => {\n      if (rowNumber !== 1) {\n        let zoneString = row.getCell(4).value!.toString();\n\n        // Zone\n        let zoneResult = Queries.getZoneFromObjectModel(model, zoneString);\n        if (zoneResult === undefined) {\n          // insert new zone\n          model.zones.push(new Zone(zoneString, new Array<UserMap>()));\n        }\n\n        // Carte\n        let usermapResult = Queries.getUserMapFromObjectModel(\n          model,\n          zoneString,\n          defaultMap\n        );\n        if (usermapResult === undefined) {\n          let insertMap = new UserMap(\n            defaultMap,\n            \"none\",\n            new Array<Trail>(),\n            new Array<InterestPoint>(),\n            new Coordinate(-1, -1),\n            new Coordinate(-1, -1),\n            new Coordinate(-1, -1),\n            new Coordinate(-1, -1)\n          );\n          Queries.insertUserMapInZoneMaps({ ref: model }, insertMap, {\n            zone_name: zoneString,\n          });\n        }\n\n        // InterestPoint\n        let type = row.getCell(5).value!.toString();\n        let poiName = row.getCell(2).value!.toString();\n        let altitude = row.getCell(3).value!.toString();\n        let longitude = row.getCell(18).value!.toString();\n        let latitude = row.getCell(19).value!.toString();\n        let insertedType = InterestPoint.getTypeFromString(type);\n\n        let newPOI = new InterestPoint(\n          poiName,\n          \"none\",\n          insertedType,\n          new Coordinate(Number(longitude), Number(latitude), Number(altitude)),\n          \"none\",\n          undefined,\n          undefined\n        );\n\n        Queries.insertInterestPointInUserMap({ ref: model }, newPOI, {\n          usermap_name: defaultMap,\n          zone_name: zoneString,\n        });\n      }\n    });\n    let write_success = this.ReverseEngineerWorkbookProgrammatically(\n      xlsx,\n      model\n    );\n    return write_success;\n  }\n\n  /**\n   *\n   *\n   * Méthode pour aller chercher des données à partir d'un fichier Excel.\n   *\n   * @param file Le fichier duquel on veut extraire les données.\n   * @returns un objet CompleteModel.\n   */\n  static async fetchDataFromExcel(file: File) {\n    const Excel = require(\"exceljs\");\n    let wb: Workbook = new Excel.Workbook();\n    let model = new CompleteModel();\n    let model_by_ref = { ref: model };\n    let separator = \", \";\n\n    // @ts-ignore\n    var arrayBuff = await file.arrayBuffer();\n    var buffer = await ImportExcelFile.toBuffer(arrayBuff);\n    return Promise.resolve(\n      await wb.xlsx.load(buffer).then(async (book) => {\n        try {\n          // Zone\n          var ws_Zone: Worksheet = book.getWorksheet(\"Zones\");\n          ws_Zone.eachRow(function (row, rowNumber) {\n            let zone_maps = new Array<UserMap>();\n            if (rowNumber !== 1) {\n              let cellvalue = row.getCell(1).value!.toString();\n              let z = new Zone(cellvalue, zone_maps);\n              model.zones.push(z);\n            }\n          });\n\n          // UserMap\n          var ws_UserMap: Worksheet = book.getWorksheet(\"Carte\");\n          ws_UserMap.eachRow(\n            await async function (row, rowNumber) {\n              let sentiers = Array<Trail>();\n              let interest_points = Array<InterestPoint>();\n              if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n                let key = {\n                  zone_name: row.getCell(1).value!.toString(),\n                };\n                let usermap_name = row.getCell(2).value!.toString();\n                let filepath = row.getCell(3).value!.toString();\n\n                let tlLong = undefined;\n                let tlLat = undefined;\n                let trLong = undefined;\n                let trLat = undefined;\n                let blLong = undefined;\n                let blLat = undefined;\n                let brLong = undefined;\n                let brLat = undefined;\n\n                if (row.getCell(4).value)\n                  tlLong = Number(row.getCell(4).value!.toString());\n                if (row.getCell(5).value)\n                  tlLat = Number(row.getCell(5).value!.toString());\n                if (row.getCell(6).value)\n                  trLong = Number(row.getCell(6).value!.toString());\n                if (row.getCell(7).value)\n                  trLat = Number(row.getCell(7).value!.toString());\n                if (row.getCell(8).value)\n                  blLong = Number(row.getCell(8).value!.toString());\n                if (row.getCell(9).value)\n                  blLat = Number(row.getCell(9).value!.toString());\n                if (row.getCell(10).value)\n                  brLong = Number(row.getCell(10).value!.toString());\n                if (row.getCell(11).value)\n                  brLat = Number(row.getCell(11).value!.toString());\n\n                let um = new UserMap(\n                  usermap_name,\n                  filepath,\n                  sentiers,\n                  interest_points,\n                  new Coordinate(tlLong, tlLat),\n                  new Coordinate(trLong, trLat),\n                  new Coordinate(blLong, blLat),\n                  new Coordinate(brLong, brLat)\n                );\n\n                await Queries.insertUserMapInZoneMaps(model_by_ref, um, key);\n              }\n            }\n          );\n\n          // Sentier\n          var ws_Trail: Worksheet = book.getWorksheet(\"Sentier\");\n          ws_Trail.eachRow(\n            await async function (row, rowNumber) {\n              if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n                let keyCell = row.getCell(1).value!.toString().split(separator);\n\n                let key = {\n                  zone_name: keyCell[0],\n                  usermap_name: keyCell[1],\n                };\n\n                let trailDescription = undefined;\n                let difficulty = -1;\n                let color = \"black\";\n                let dateDebut = undefined;\n                let dateFin = undefined;\n\n                let trailName = row.getCell(2).value!.toString();\n                if (row.getCell(3).value)\n                  trailDescription = row.getCell(3).value!.toString();\n                if (row.getCell(4).value)\n                  difficulty = Number(row.getCell(4).value!.toString());\n                if (row.getCell(5).value)\n                  color = row.getCell(5).value!.toString();\n\n                if (row.getCell(6)) {\n                  let dateDebutString: any = row.getCell(6).value!.toString();\n                  let day = dateDebutString.substr(0, 2);\n                  let month = dateDebutString.substr(3, 2) - 1;\n                  if (day !== \"\" && month !== -1)\n                    dateDebut = new Date(1900, Number(month), Number(day));\n                }\n\n                if (row.getCell(7)) {\n                  let dateFinString: any = row.getCell(7).value!.toString();\n                  let day = dateFinString.substr(0, 2);\n                  let month = dateFinString.substr(3, 2) - 1;\n                  if (day !== \"\" && month !== -1)\n                    dateFin = new Date(1900, Number(month), Number(day));\n                }\n\n                let s = new Trail(\n                  trailName,\n                  trailDescription,\n                  difficulty,\n                  dateDebut,\n                  dateFin,\n                  color\n                );\n\n                await Queries.insertSentierInUserMap(model_by_ref, s, key);\n              }\n            }\n          );\n\n          // Coordonnées de sentiers\n          var ws_coordinateSentier: Worksheet = book.getWorksheet(\n            \"Coordonnees de Sentier\"\n          );\n          ws_coordinateSentier.eachRow(\n            await async function (row, rowNumber) {\n              if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n                let keyCell = row.getCell(1).value!.toString().split(separator);\n\n                let key = {\n                  zone_name: keyCell[0],\n                  usermap_name: keyCell[1],\n                  sentier_name: keyCell[2],\n                };\n\n                let longitude = undefined;\n                let latitude = undefined;\n                let altitude = undefined;\n\n                if (row.getCell(2).value)\n                  longitude = Number(row.getCell(2).value!.toString());\n                if (row.getCell(3).value)\n                  latitude = Number(row.getCell(3).value!.toString());\n                if (row.getCell(4).value)\n                  altitude = Number(row.getCell(4).value!.toString());\n\n                let c = new Coordinate(longitude, latitude, altitude);\n\n                await Queries.insertCoordinateInSentier(model_by_ref, c, key);\n              }\n            }\n          );\n\n          // Point d'interet\n          var ws_interestPoints: Worksheet = book.getWorksheet(\n            \"Point d'interet\"\n          );\n          ws_interestPoints.eachRow(\n            await async function (row, rowNumber) {\n              if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n                let keyCell = row.getCell(1).value!.toString().split(separator);\n\n                let key = {\n                  zone_name: keyCell[0],\n                  usermap_name: keyCell[1],\n                };\n\n                let poiTypeString = \"unknown\";\n                let description = \"\";\n                let poiLong = undefined;\n                let poiLat = undefined;\n                let dateDebut = undefined;\n                let dateFin = undefined;\n\n                let poiName = row.getCell(2).value!.toString();\n                if (row.getCell(3).value)\n                  description = row.getCell(3).value!.toString();\n\n                if (row.getCell(4).value)\n                  poiTypeString = row.getCell(4).value!.toString();\n                let it = getInterestType(poiTypeString);\n\n                if (row.getCell(5))\n                  poiLong = Number(row.getCell(5).value!.toString());\n                if (row.getCell(6))\n                  poiLat = Number(row.getCell(6).value!.toString());\n\n                if (row.getCell(7)) {\n                  let dateDebutString: any = row.getCell(5).value!.toString();\n                  let month = dateDebutString.substr(0, 2) - 1;\n                  let day = dateDebutString.substr(3, 2);\n                  dateDebut = new Date(month, day);\n                }\n\n                if (row.getCell(8)) {\n                  let dateFinString: any = row.getCell(8).value!.toString();\n                  let month = dateFinString.substr(0, 2) - 1;\n                  let day = dateFinString.substr(3, 2);\n                  dateFin = new Date(month, day);\n                }\n\n                let ip = new InterestPoint(\n                  poiName,\n                  description,\n                  it,\n                  new Coordinate(poiLong, poiLat),\n                  \"code\",\n                  dateDebut,\n                  dateFin\n                );\n\n                await Queries.insertInterestPointInUserMap(\n                  model_by_ref,\n                  ip,\n                  key\n                );\n              }\n            }\n          );\n\n          // Données d'un point d'interet\n          var ws_interestPointsData: Worksheet = book.getWorksheet(\n            \"Fichiers de point d'interet\"\n          );\n          ws_interestPointsData.eachRow(\n            await async function (row, rowNumber) {\n              if (rowNumber !== 1 && row.getCell(1).value !== undefined) {\n                let keyCell = row.getCell(1).value!.toString().split(separator);\n\n                let key = {\n                  zone_name: keyCell[0],\n                  usermap_name: keyCell[1],\n                  interest_point_name: keyCell[2],\n                };\n\n                let ipd_type = row.getCell(2).value!.toString();\n                let datatype = getDataType(ipd_type);\n\n                let ipd_data = row.getCell(3).value!.toString();\n\n                let ip = new InterestPointData(datatype, ipd_data);\n\n                await Queries.insertInterestPointDataInInterestPoint(\n                  model_by_ref,\n                  ip,\n                  key\n                );\n              }\n            }\n          );\n        } catch (err) {\n          console.log(err);\n          return Promise.resolve(new CompleteModel());\n        }\n        return Promise.resolve(model);\n      })\n    );\n  }\n\n  /**\n   * Produit un Buffer à partir d'un objet 'ArrayBuffer'.\n   *\n   * @param model L'objet 'ArrayBuffer'.\n   * @returns un Buffer.\n   */\n  static async toBuffer(ab: ArrayBuffer) {\n    var buf = Buffer.alloc(ab.byteLength);\n    var view = new Uint8Array(ab);\n    for (var i = 0; i < buf.length; ++i) {\n      buf[i] = view[i];\n    }\n    return buf;\n  }\n\n  /**\n   * Produit un fichier Excel à partir d'un objet 'CompleteModel'.\n   *\n   * @param filename Le nom que l'on veut donner à notre feuille Excel.\n   * @param model L'objet 'CompleteModel' à insérer dans une feuille Excel.\n   * @returns \"write succesful\" si la méthode n'a pas rencontré d'erreur.\n   */\n  static async ReverseEngineerWorkbookProgrammatically(\n    filename: string,\n    model: CompleteModel\n  ) {\n    const wb: Workbook = new Workbook();\n\n    /** # general info */\n    wb.creator = \"Sentiers de l'Estrie\";\n    wb.created = new Date();\n\n    /** # make sheets */\n    const key_sheet = wb.addWorksheet(\"Keys\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const zone_sheet = wb.addWorksheet(\"Zones\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const usermap_sheet = wb.addWorksheet(\"Carte\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const sentier_sheet = wb.addWorksheet(\"Sentier\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const coordinateSentier_sheet = wb.addWorksheet(\"Coordonnees de Sentier\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const interestPoint_sheet = wb.addWorksheet(\"Point d'interet\", {\n      views: [{ state: \"frozen\", ySplit: 1 }],\n    });\n    const interestPointData_sheet = wb.addWorksheet(\n      \"Fichiers de point d'interet\",\n      { views: [{ state: \"frozen\", ySplit: 1 }] }\n    );\n\n    /** ## make tables within spreadsheets that contain row names, column names, data */\n    var ExcelModel = this.FormatModelToExcel(model);\n    var ColumnsModel = this.MakeColumnsMap();\n\n    this.addTableWrapper(\n      zone_sheet,\n      \"tableau_zones\",\n      ColumnsModel,\n      ExcelModel,\n      \"zones\"\n    );\n    this.addTableWrapper(\n      usermap_sheet,\n      \"tableau_cartes\",\n      ColumnsModel,\n      ExcelModel,\n      \"user_maps\"\n    );\n    this.addTableWrapper(\n      sentier_sheet,\n      \"tableau_sentiers\",\n      ColumnsModel,\n      ExcelModel,\n      \"sentiers\"\n    );\n    this.addTableWrapper(\n      coordinateSentier_sheet,\n      \"tableau_coordinateSentiers\",\n      ColumnsModel,\n      ExcelModel,\n      \"coordinate_sentiers\"\n    );\n    this.addTableWrapper(\n      interestPoint_sheet,\n      \"tableau_interestPoint\",\n      ColumnsModel,\n      ExcelModel,\n      \"interest_points\"\n    );\n    this.addTableWrapper(\n      interestPointData_sheet,\n      \"tableau_interestPointData\",\n      ColumnsModel,\n      ExcelModel,\n      \"interest_points_data\"\n    );\n\n    /** # Data validation */\n    /** ## Configure single key as defined name */\n    zone_sheet\n      .getColumn(\"A\")\n      .eachCell({ includeEmpty: true }, function (cell, rowNumber) {\n        if (rowNumber !== 1) {\n          cell.name = \"Zone_ID\";\n        }\n      });\n\n    /** ## Configure composite keys sheet */\n    var separator = '\", \"';\n    // @ts-ignore\n    wb.definedNames.addFormula(\n      \"CONCATENATE(Carte!$A$2:$A$4,\" + separator + \",Carte!$B$2:$B$4)\",\n      \"Cartes_ID\"\n    );\n    // @ts-ignore\n    wb.definedNames.addFormula(\n      \"CONCATENATE(Sentier!$A$2:$A$4,\" + separator + \",Sentier!$B$2:$B$4)\",\n      \"Sentier_ID\"\n    );\n    // @ts-ignore\n    wb.definedNames.addFormula(\n      \"CONCATENATE('Point d''interet'!$A$2:$A$4,\" +\n        separator +\n        \",'Point d''interet'!$B$2:$B$4)\",\n      \"PointInteret_ID\"\n    );\n\n    //keys\n    key_sheet.getCell(\"A1\").value = \"Cartes_ID\";\n    key_sheet.getCell(\"A2\").value = \"=Cartes_ID\";\n\n    key_sheet.getCell(\"B1\").value = \"Sentier_ID\";\n    key_sheet.getCell(\"B2\").value = \"=Sentier_ID\";\n\n    key_sheet.getCell(\"C1\").value = \"PointInteret_ID\";\n    key_sheet.getCell(\"C2\").value = \"=PointInteret_ID\";\n\n    /** # Add validation to first column */\n    this.dataValidationWrapper(\n      usermap_sheet,\n      \"Zone_ID\",\n      \"'ID: Zone'\",\n      \"'Zone'\"\n    );\n    this.dataValidationWrapper(\n      sentier_sheet,\n      \"Keys!A:A\",\n      \"'ID: Zone', 'ID: Nom'\",\n      \"'Carte'\"\n    );\n    this.dataValidationWrapper(\n      coordinateSentier_sheet,\n      \"Keys!B:B\",\n      \"'ID: Carte', 'ID: Nom'\",\n      \"'Sentier'\"\n    );\n    this.dataValidationWrapper(\n      interestPoint_sheet,\n      \"Keys!A:A\",\n      \"'ID: Zone', 'ID: Nom'\",\n      \"'Carte'\"\n    );\n    this.dataValidationWrapper(\n      interestPointData_sheet,\n      \"Keys!C:C\",\n      \"'ID: Sentier', 'ID: Nom'\",\n      \"'Point d'interet'\"\n    );\n\n    await wb.xlsx.writeFile(filename);\n\n    return \"write succesful\";\n  }\n\n  /**\n   * Abstraction pour ajouter un 'table Excel' contenant les données dans un fichier Excel\n   * @param sheet Une feuille du fichier Excel.\n   * @param table_name Nom à attribuer à la table.\n   * @param columns Le nom donné à chaque colonne de l'entité 'table Excel'.\n   * @param excel_model La map des colonnes pour chaque feuille Excel.\n   * @param model_key La clé du paramètre 'excel_model' pour obtenir les colonnes à ajouter au 'table Excel'.\n   */\n  private static addTableWrapper(\n    sheet: Worksheet,\n    table_name: string,\n    columns: any,\n    excel_model: Map<any, any>,\n    model_key: string\n  ) {\n    sheet.addTable({\n      name: table_name,\n      ref: \"A1\",\n      headerRow: true,\n      style: {\n        theme: \"TableStyleDark3\",\n        showRowStripes: true,\n      },\n      columns: columns.get(model_key),\n      rows: excel_model.get(model_key),\n    });\n    this.makeColumnsPretty(sheet);\n  }\n\n  /** Création statique de la définition des colonnes pour les 'tables Excel'. */\n  private static MakeColumnsMap() {\n    let ColumnsMap = new Map();\n\n    var zone_columns = [{ name: \"ID: Nom\", filterButton: true }];\n\n    var usermap_columns = [\n      { name: \"ID: Zone\", filterButton: true },\n      { name: \"ID: Nom\", filterButton: true },\n      { name: \"Path\", filterButton: true },\n      { name: \"Coin gauche sup. longitude\", filterButton: true },\n      { name: \"Coin gauche sup. latitude\", filterButton: true },\n      { name: \"Coin droit sup. longitude\", filterButton: true },\n      { name: \"Coin droit sup. latitude\", filterButton: true },\n      { name: \"Coin gauche inf. longitude\", filterButton: true },\n      { name: \"Coin gauche inf. latitude\", filterButton: true },\n      { name: \"Coin droit inf. longitude\", filterButton: true },\n      { name: \"Coin droit inf. latitude\", filterButton: true },\n    ];\n\n    var sentier_columns = [\n      { name: \"ID: Zone, Carte\", filterButton: true },\n      { name: \"ID: Nom\", filterButton: true },\n      { name: \"Description\", filterButton: true },\n      { name: \"Difficultée\", filterButton: true },\n      { name: \"Couleur du sentier\", filterButton: true },\n      { name: \"Date de début\", filterButton: true },\n      { name: \"Date de fin\", filterButton: true },\n    ];\n\n    var coordinateSentiers_columns = [\n      { name: \"ID: Zone, Carte, Sentier\", filterButton: true },\n      { name: \"Longitude\", filterButton: true },\n      { name: \"Latitude\", filterButton: true },\n      { name: \"Altitude\", filterButton: true },\n    ];\n\n    var interestPoint_columns = [\n      { name: \"ID: Zone, Carte\", filterButton: true },\n      { name: \"ID: Nom\", filterButton: true },\n      { name: \"Description\", filterButton: true },\n      { name: \"Type d'intérêt\", filterButton: true },\n      { name: \"Date de début\", filterButton: true },\n      { name: \"Date de fin\", filterButton: true },\n      { name: \"Longitude\", filterButton: true },\n      { name: \"Latitude\", filterButton: true },\n    ];\n\n    var interestPointData_columns = [\n      { name: \"ID: Point d'interet\", filterButton: true },\n      { name: \"Type de donnee\", filterButton: true },\n      { name: \"Donnee\", filterButton: true },\n    ];\n\n    ColumnsMap.set(\"zones\", zone_columns);\n    ColumnsMap.set(\"user_maps\", usermap_columns);\n    ColumnsMap.set(\"sentiers\", sentier_columns);\n    ColumnsMap.set(\"coordinate_sentiers\", coordinateSentiers_columns);\n    ColumnsMap.set(\"interest_points\", interestPoint_columns);\n    ColumnsMap.set(\"interest_points_data\", interestPointData_columns);\n\n    return ColumnsMap;\n  }\n\n  /**\n   * Insère les lignes de Excel dans un objet CompleteModel.\n   * @param model Un objet CompleteModel.\n   * @returns Un objet CompleteModel.\n   */\n  static FormatModelToExcel(model: CompleteModel) {\n    const separator = \", \";\n    let ExcelModel = new Map();\n\n    const zoneRows: string[][] = [];\n    const usermapRows: any[][] = [];\n    const sentierRows: any[][] = [];\n    const coordinateSentierRows: any[][] = [];\n    const interestPointRows: any[][] = [];\n    const interestPointDataRows: any[][] = [];\n\n    model.zones.forEach(function (zone) {\n      zoneRows.push([zone._id]);\n\n      zone.maps.forEach(function (usermap) {\n        usermapRows.push([\n          zone._id,\n          usermap.name,\n          usermap.map_file,\n          usermap.topLeftCoordinate.longitude,\n          usermap.topLeftCoordinate.latitude,\n          usermap.topRightCoordinate.longitude,\n          usermap.topRightCoordinate.latitude,\n          usermap.bottomLeftCoordinate.longitude,\n          usermap.bottomLeftCoordinate.latitude,\n          usermap.bottomRightCoordinate.longitude,\n          usermap.bottomRightCoordinate.latitude,\n        ]);\n\n        usermap.trails.forEach(function (trail) {\n          let debutDate = \"\";\n          let finDate = \"\";\n          if (trail.activeWindow !== undefined) {\n            let debutDateDayNumber: number = trail.activeWindow[0].getDate();\n            let debutDateMonthNumber: number = trail.activeWindow[0].getMonth();\n\n            let finDateDayNumber: number = trail.activeWindow[1].getDate();\n            let finDateMonthNumber: number = trail.activeWindow[1].getMonth();\n\n            debutDate = ImportExcelFile.FormatDateNumbersToString(\n              debutDateDayNumber,\n              debutDateMonthNumber\n            );\n            finDate = ImportExcelFile.FormatDateNumbersToString(\n              finDateDayNumber,\n              finDateMonthNumber\n            );\n          }\n          sentierRows.push([\n            zone._id + separator + usermap.name,\n            trail.name,\n            trail.description,\n            trail.difficulty,\n            trail.color,\n            debutDate,\n            finDate,\n          ]);\n\n          trail.trailCoordinates.forEach(function (point) {\n            coordinateSentierRows.push([\n              zone._id + separator + usermap.name + separator + trail.name,\n              point.longitude,\n              point.latitude,\n              point.altitude,\n            ]);\n          });\n        });\n\n        usermap.pointsOfInterest.forEach(function (interest_point) {\n          let debutDate = \"\";\n          let finDate = \"\";\n          if (interest_point.activeWindow !== undefined) {\n            let debutDateDayNumber: number = interest_point.activeWindow[0].getDate();\n            let debutDateMonthNumber: number = interest_point.activeWindow[0].getMonth();\n\n            let finDateDayNumber: number = interest_point.activeWindow[1].getDate();\n            let finDateMonthNumber: number = interest_point.activeWindow[1].getMonth();\n\n            debutDate = ImportExcelFile.FormatDateNumbersToString(\n              debutDateDayNumber,\n              debutDateMonthNumber\n            );\n            finDate = ImportExcelFile.FormatDateNumbersToString(\n              finDateDayNumber,\n              finDateMonthNumber\n            );\n          }\n\n          interestPointRows.push([\n            zone._id + separator + usermap.name,\n            interest_point.name,\n            interest_point.description,\n            interest_point.type,\n            debutDate,\n            finDate,\n            interest_point.coordinate.longitude,\n            interest_point.coordinate.latitude,\n          ]);\n\n          interest_point.data.forEach(function (interest_point_data) {\n            interestPointDataRows.push([\n              zone._id +\n                separator +\n                usermap.name +\n                separator +\n                interest_point.name,\n              interest_point_data.type,\n              interest_point_data.data,\n            ]);\n          });\n        });\n      });\n    });\n\n    ExcelModel.set(\"zones\", zoneRows);\n    ExcelModel.set(\"user_maps\", usermapRows);\n    ExcelModel.set(\"sentiers\", sentierRows);\n    ExcelModel.set(\"coordinate_sentiers\", coordinateSentierRows);\n    ExcelModel.set(\"interest_points\", interestPointRows);\n    ExcelModel.set(\"interest_points_data\", interestPointDataRows);\n\n    return ExcelModel;\n  }\n\n  /**\n   * Ajuste la longueur des colonnes\n   * @param sheet Une feuille du fichier Excel.\n   */\n  static makeColumnsPretty(sheet: Worksheet) {\n    sheet.columns.forEach((column) => {\n      var maxLength = 0;\n      // @ts-ignore\n      column.eachCell({ includeEmpty: true }, function (cell, rowNumber) {\n        var columnLength = cell.value ? cell.value.toString().length : 10;\n        if (columnLength > maxLength) {\n          maxLength = columnLength;\n        }\n      });\n      column.width = maxLength < 10 ? 10 : maxLength;\n    });\n  }\n\n  /**\n   * Abstraction pour ajouter une validation des données à la première colonne d'une feuille Excel\n   * @param sheet Une feuille du fichier Excel.\n   * @param formula La formule en VBA pour la validation des données.\n   * @param foreign_key Spécifie à l'utilisateur quelles colonnes composent la clé étrangère de cette feuille.\n   * @param feuille Spécifie à l'utilisateur l'entitée parente de cette feuille, le lien de dépendance.\n   */\n  private static dataValidationWrapper(\n    sheet: Worksheet,\n    formula: string,\n    foreign_key: string,\n    feuille: string\n  ) {\n    sheet\n      .getColumn(\"A\")\n      .eachCell({ includeEmpty: true }, function (cell, rowNumber) {\n        if (rowNumber !== 1) {\n          cell.dataValidation = {\n            type: \"list\",\n            allowBlank: true,\n            showInputMessage: true,\n            formulae: [formula],\n            // showErrorMessage: true,\n            promptTitle: \"Foreign Key\",\n            prompt:\n              \"La valeur doit être présente dans la colonne \" +\n              foreign_key +\n              \" de la feuille \" +\n              feuille +\n              \".\",\n          };\n        }\n      });\n  }\n\n  /**\n   * Prends les nombre retournés par la librairies standard de typescript pour les dates et les met dans le format qui\n   * sera lu par le parser de fichier Excel, soit: dd-mm en string.\n   * @param dateDayNumber le chiffre retourné par une date de la librairie standard lors de l'appel getDate().\n   * @param dateMonthNumber le chiffre retourné par une date de la librairie standard lors de l'appel getMonth().\n   * @returns une date dans le format dd-mm\n   */\n  private static FormatDateNumbersToString(\n    dateDayNumber: number,\n    dateMonthNumber: number\n  ) {\n    let day;\n    let month;\n\n    if (dateDayNumber < 10) day = \"0\" + dateDayNumber.toString();\n    else day = dateDayNumber.toString();\n\n    if (dateMonthNumber < 10) month = \"0\" + dateMonthNumber.toString();\n    else month = dateMonthNumber.toString();\n\n    return day + \"-\" + month;\n  }\n}\n"],"sourceRoot":""}